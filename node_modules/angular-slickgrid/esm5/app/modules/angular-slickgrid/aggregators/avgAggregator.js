var AvgAggregator = /** @class */ (function () {
    function AvgAggregator(field) {
        this._count = 0;
        this._field = field;
    }
    AvgAggregator.prototype.init = function () {
        this._count = 0;
        this._nonNullCount = 0;
        this._sum = 0;
    };
    AvgAggregator.prototype.accumulate = function (item) {
        var val = (item && item.hasOwnProperty(this._field)) ? item[this._field] : null;
        this._count++;
        if (val !== null && val !== undefined && val !== '' && !isNaN(val)) {
            this._nonNullCount++;
            this._sum += parseFloat(val);
        }
    };
    AvgAggregator.prototype.storeResult = function (groupTotals) {
        if (!groupTotals || groupTotals.avg === undefined) {
            groupTotals.avg = {};
        }
        if (this._nonNullCount !== 0) {
            groupTotals.avg[this._field] = this._sum / this._nonNullCount;
        }
    };
    return AvgAggregator;
}());
export { AvgAggregator };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXZnQWdncmVnYXRvci5qcyIsInNvdXJjZVJvb3QiOiJuZzovL2FuZ3VsYXItc2xpY2tncmlkLyIsInNvdXJjZXMiOlsiYXBwL21vZHVsZXMvYW5ndWxhci1zbGlja2dyaWQvYWdncmVnYXRvcnMvYXZnQWdncmVnYXRvci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFQTtJQU1FLHVCQUFZLEtBQXNCO1FBTDFCLFdBQU0sR0FBRyxDQUFDLENBQUM7UUFNakIsSUFBSSxDQUFDLE1BQU0sR0FBRyxLQUFLLENBQUM7SUFDdEIsQ0FBQztJQUVELDRCQUFJLEdBQUo7UUFDRSxJQUFJLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztRQUNoQixJQUFJLENBQUMsYUFBYSxHQUFHLENBQUMsQ0FBQztRQUN2QixJQUFJLENBQUMsSUFBSSxHQUFHLENBQUMsQ0FBQztJQUNoQixDQUFDO0lBRUQsa0NBQVUsR0FBVixVQUFXLElBQVM7UUFDbEIsSUFBTSxHQUFHLEdBQUcsQ0FBQyxJQUFJLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO1FBQ2xGLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNkLElBQUksR0FBRyxLQUFLLElBQUksSUFBSSxHQUFHLEtBQUssU0FBUyxJQUFJLEdBQUcsS0FBSyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLEVBQUU7WUFDbEUsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1lBQ3JCLElBQUksQ0FBQyxJQUFJLElBQUksVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQzlCO0lBQ0gsQ0FBQztJQUVELG1DQUFXLEdBQVgsVUFBWSxXQUFnQjtRQUMxQixJQUFJLENBQUMsV0FBVyxJQUFJLFdBQVcsQ0FBQyxHQUFHLEtBQUssU0FBUyxFQUFFO1lBQ2pELFdBQVcsQ0FBQyxHQUFHLEdBQUcsRUFBRSxDQUFDO1NBQ3RCO1FBQ0QsSUFBSSxJQUFJLENBQUMsYUFBYSxLQUFLLENBQUMsRUFBRTtZQUM1QixXQUFXLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUM7U0FDL0Q7SUFDSCxDQUFDO0lBQ0gsb0JBQUM7QUFBRCxDQUFDLEFBakNELElBaUNDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWdncmVnYXRvciB9IGZyb20gJy4vLi4vbW9kZWxzL2FnZ3JlZ2F0b3IuaW50ZXJmYWNlJztcclxuXHJcbmV4cG9ydCBjbGFzcyBBdmdBZ2dyZWdhdG9yIGltcGxlbWVudHMgQWdncmVnYXRvciB7XHJcbiAgcHJpdmF0ZSBfY291bnQgPSAwO1xyXG4gIHByaXZhdGUgX25vbk51bGxDb3VudDogbnVtYmVyO1xyXG4gIHByaXZhdGUgX3N1bTogbnVtYmVyO1xyXG4gIHByaXZhdGUgX2ZpZWxkOiBudW1iZXIgfCBzdHJpbmc7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGZpZWxkOiBudW1iZXIgfCBzdHJpbmcpIHtcclxuICAgIHRoaXMuX2ZpZWxkID0gZmllbGQ7XHJcbiAgfVxyXG5cclxuICBpbml0KCk6IHZvaWQge1xyXG4gICAgdGhpcy5fY291bnQgPSAwO1xyXG4gICAgdGhpcy5fbm9uTnVsbENvdW50ID0gMDtcclxuICAgIHRoaXMuX3N1bSA9IDA7XHJcbiAgfVxyXG5cclxuICBhY2N1bXVsYXRlKGl0ZW06IGFueSkge1xyXG4gICAgY29uc3QgdmFsID0gKGl0ZW0gJiYgaXRlbS5oYXNPd25Qcm9wZXJ0eSh0aGlzLl9maWVsZCkpID8gaXRlbVt0aGlzLl9maWVsZF0gOiBudWxsO1xyXG4gICAgdGhpcy5fY291bnQrKztcclxuICAgIGlmICh2YWwgIT09IG51bGwgJiYgdmFsICE9PSB1bmRlZmluZWQgJiYgdmFsICE9PSAnJyAmJiAhaXNOYU4odmFsKSkge1xyXG4gICAgICB0aGlzLl9ub25OdWxsQ291bnQrKztcclxuICAgICAgdGhpcy5fc3VtICs9IHBhcnNlRmxvYXQodmFsKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHN0b3JlUmVzdWx0KGdyb3VwVG90YWxzOiBhbnkpIHtcclxuICAgIGlmICghZ3JvdXBUb3RhbHMgfHwgZ3JvdXBUb3RhbHMuYXZnID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgZ3JvdXBUb3RhbHMuYXZnID0ge307XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5fbm9uTnVsbENvdW50ICE9PSAwKSB7XHJcbiAgICAgIGdyb3VwVG90YWxzLmF2Z1t0aGlzLl9maWVsZF0gPSB0aGlzLl9zdW0gLyB0aGlzLl9ub25OdWxsQ291bnQ7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiJdfQ==