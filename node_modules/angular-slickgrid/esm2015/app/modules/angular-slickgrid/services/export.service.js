import * as tslib_1 from "tslib";
import { Injectable, Optional } from '@angular/core';
import { TranslateService } from '@ngx-translate/core';
import { TextEncoder } from 'text-encoding-utf-8';
import { Subject } from 'rxjs';
import { FileType, } from './../models/index';
import { Constants } from './../constants';
import { exportWithFormatterWhenDefined } from './export-utilities';
import { addWhiteSpaces, getTranslationPrefix, htmlEntityDecode, sanitizeHtmlToText, titleCase } from './../services/utilities';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@ngx-translate/core';
let ExportService = class ExportService {
    constructor(translate) {
        this.translate = translate;
        this._delimiter = ',';
        this._fileFormat = FileType.csv;
        this._lineCarriageReturn = '\n';
        this._exportQuoteWrapper = '';
        this._hasGroupedItems = false;
        this.onGridBeforeExportToFile = new Subject();
        this.onGridAfterExportToFile = new Subject();
    }
    get datasetIdName() {
        return this._gridOptions && this._gridOptions.datasetIdPropertyName || 'id';
    }
    /** Getter for the Grid Options pulled through the Grid Object */
    get _gridOptions() {
        return (this._grid && this._grid.getOptions) ? this._grid.getOptions() : {};
    }
    /**
     * Initialize the Export Service
     * @param grid
     * @param gridOptions
     * @param dataView
     */
    init(grid, dataView) {
        this._grid = grid;
        this._dataView = dataView;
        // get locales provided by user in forRoot or else use default English locales via the Constants
        this._locales = this._gridOptions && this._gridOptions.locales || Constants.locales;
        if (this._gridOptions.enableTranslate && (!this.translate || !this.translate.instant)) {
            throw new Error('[Angular-Slickgrid] requires "ngx-translate" to be installed and configured when the grid option "enableTranslate" is enabled.');
        }
    }
    /**
     * Function to export the Grid result to an Excel CSV format using javascript for it to produce the CSV file.
     * This is a WYSIWYG export to file output (What You See is What You Get)
     *
     * NOTES: The column position needs to match perfectly the JSON Object position because of the way we are pulling the data,
     * which means that if any column(s) got moved in the UI, it has to be reflected in the JSON array output as well
     *
     * Example: exportToFile({ format: FileType.csv, delimiter: DelimiterType.comma })
     */
    exportToFile(options) {
        if (!this._grid || !this._dataView) {
            throw new Error('[Angular-Slickgrid] it seems that the SlickGrid & DataView objects are not initialized did you forget to enable the grid option flag "enableExcelExport"?');
        }
        return new Promise((resolve, reject) => {
            this.onGridBeforeExportToFile.next(true);
            this._exportOptions = $.extend(true, {}, this._gridOptions.exportOptions, options);
            this._delimiter = this._exportOptions.delimiterOverride || this._exportOptions.delimiter || '';
            this._fileFormat = this._exportOptions.format || FileType.csv;
            // get the CSV output from the grid data
            const dataOutput = this.getDataOutput();
            // trigger a download file
            // wrap it into a setTimeout so that the EventAggregator has enough time to start a pre-process like showing a spinner
            setTimeout(() => {
                try {
                    const downloadOptions = {
                        filename: `${this._exportOptions.filename}.${this._fileFormat}`,
                        format: this._fileFormat,
                        useUtf8WithBom: this._exportOptions.hasOwnProperty('useUtf8WithBom') ? this._exportOptions.useUtf8WithBom : true
                    };
                    // start downloading but add the content property only on the start download not on the event itself
                    this.startDownloadFile(Object.assign({}, downloadOptions, { content: dataOutput })); // add content property
                    this.onGridAfterExportToFile.next(downloadOptions);
                    resolve(true);
                }
                catch (error) {
                    reject(error);
                }
            }, 0);
        });
    }
    /**
     * Triggers download file with file format.
     * IE(6-10) are not supported
     * All other browsers will use plain javascript on client side to produce a file download.
     * @param options
     */
    startDownloadFile(options) {
        // IE(6-10) don't support javascript download and our service doesn't support either so throw an error, we have to make a round trip to the Web Server for exporting
        if (navigator.appName === 'Microsoft Internet Explorer') {
            throw new Error('Microsoft Internet Explorer 6 to 10 do not support javascript export to CSV. Please upgrade your browser.');
        }
        // set the correct MIME type
        const mimeType = (options.format === FileType.csv) ? 'text/csv' : 'text/plain';
        // make sure no html entities exist in the data
        const dataContent = htmlEntityDecode(options.content);
        // dealing with Excel CSV export and UTF-8 is a little tricky.. We will use Option #2 to cover older Excel versions
        // Option #1: we need to make Excel knowing that it's dealing with an UTF-8, A correctly formatted UTF8 file can have a Byte Order Mark as its first three octets
        // reference: http://stackoverflow.com/questions/155097/microsoft-excel-mangles-diacritics-in-csv-files
        // Option#2: use a 3rd party extension to javascript encode into UTF-16
        let outputData;
        if (options.format === FileType.csv) {
            outputData = new TextEncoder('utf-8').encode(dataContent);
        }
        else {
            outputData = dataContent;
        }
        // create a Blob object for the download
        const blob = new Blob([options.useUtf8WithBom ? '\uFEFF' : '', outputData], {
            type: `${mimeType};charset=utf-8;`
        });
        // when using IE/Edge, then use different download call
        if (typeof navigator.msSaveOrOpenBlob === 'function') {
            navigator.msSaveOrOpenBlob(blob, options.filename);
        }
        else {
            // this trick will generate a temp <a /> tag
            // the code will then trigger a hidden click for it to start downloading
            const link = document.createElement('a');
            const csvUrl = URL.createObjectURL(blob);
            link.textContent = 'download';
            link.href = csvUrl;
            link.setAttribute('download', options.filename);
            // set the visibility to hidden so there is no effect on your web-layout
            link.style.visibility = 'hidden';
            // this part will append the anchor tag, trigger a click (for download to start) and finally remove the tag once completed
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    }
    // -----------------------
    // Private functions
    // -----------------------
    getDataOutput() {
        const columns = this._grid.getColumns() || [];
        // Group By text, it could be set in the export options or from translation or if nothing is found then use the English constant text
        let groupByColumnHeader = this._exportOptions.groupingColumnHeaderTitle;
        if (!groupByColumnHeader && this._gridOptions.enableTranslate && this.translate && this.translate.currentLang && this.translate.instant) {
            groupByColumnHeader = this.translate.instant(`${getTranslationPrefix(this._gridOptions)}GROUP_BY`);
        }
        else if (!groupByColumnHeader) {
            groupByColumnHeader = this._locales && this._locales.TEXT_GROUP_BY;
        }
        // a CSV needs double quotes wrapper, the other types do not need any wrapper
        this._exportQuoteWrapper = (this._fileFormat === FileType.csv) ? '"' : '';
        // data variable which will hold all the fields data of a row
        let outputDataString = '';
        // get grouped column titles and if found, we will add a "Group by" column at the first column index
        // if it's a CSV format, we'll escape the text in double quotes
        const grouping = this._dataView.getGrouping();
        if (grouping && Array.isArray(grouping) && grouping.length > 0) {
            this._hasGroupedItems = true;
            outputDataString += (this._fileFormat === FileType.csv) ? `"${groupByColumnHeader}"${this._delimiter}` : `${groupByColumnHeader}${this._delimiter}`;
        }
        else {
            this._hasGroupedItems = false;
        }
        // get all Grouped Column Header Titles when defined (from pre-header row)
        if (this._gridOptions.createPreHeaderPanel && this._gridOptions.showPreHeaderPanel && !this._gridOptions.enableDraggableGrouping) {
            this._groupedColumnHeaders = this.getColumnGroupedHeaderTitles(columns) || [];
            if (this._groupedColumnHeaders && Array.isArray(this._groupedColumnHeaders) && this._groupedColumnHeaders.length > 0) {
                // add the header row + add a new line at the end of the row
                const outputGroupedHeaderTitles = this._groupedColumnHeaders.map((header) => `${this._exportQuoteWrapper}${header.title}${this._exportQuoteWrapper}`);
                outputDataString += (outputGroupedHeaderTitles.join(this._delimiter) + this._lineCarriageReturn);
            }
        }
        // get all Column Header Titles
        this._columnHeaders = this.getColumnHeaders(columns) || [];
        if (this._columnHeaders && Array.isArray(this._columnHeaders) && this._columnHeaders.length > 0) {
            // add the header row + add a new line at the end of the row
            const outputHeaderTitles = this._columnHeaders.map((header) => `${this._exportQuoteWrapper}${header.title}${this._exportQuoteWrapper}`);
            outputDataString += (outputHeaderTitles.join(this._delimiter) + this._lineCarriageReturn);
        }
        // Populate the rest of the Grid Data
        outputDataString += this.getAllGridRowData(columns, this._lineCarriageReturn);
        return outputDataString;
    }
    /**
     * Get all the grid row data and return that as an output string
     */
    getAllGridRowData(columns, lineCarriageReturn) {
        const outputDataStrings = [];
        const lineCount = this._dataView.getLength();
        // loop through all the grid rows of data
        for (let rowNumber = 0; rowNumber < lineCount; rowNumber++) {
            const itemObj = this._dataView.getItem(rowNumber);
            if (itemObj) {
                // Normal row (not grouped by anything) would have an ID which was predefined in the Grid Columns definition
                if (itemObj[this.datasetIdName] !== null && itemObj[this.datasetIdName] !== undefined) {
                    // get regular row item data
                    outputDataStrings.push(this.readRegularRowData(columns, rowNumber, itemObj));
                }
                else if (this._hasGroupedItems && itemObj.__groupTotals === undefined) {
                    // get the group row
                    outputDataStrings.push(this.readGroupedTitleRow(itemObj));
                }
                else if (itemObj.__groupTotals) {
                    // else if the row is a Group By and we have agreggators, then a property of '__groupTotals' would exist under that object
                    outputDataStrings.push(this.readGroupedTotalRow(columns, itemObj));
                }
            }
        }
        return outputDataStrings.join(lineCarriageReturn);
    }
    /**
   * Get all Grouped Header Titles and their keys, translate the title when required.
   * @param {Array<object>} columns of the grid
   */
    getColumnGroupedHeaderTitles(columns) {
        const groupedColumnHeaders = [];
        if (columns && Array.isArray(columns)) {
            // Populate the Grouped Column Header, pull the columnGroup(Key) defined
            columns.forEach((columnDef) => {
                let groupedHeaderTitle = '';
                if ((columnDef.columnGroupKey || columnDef.columnGroupKey) && this._gridOptions.enableTranslate && this.translate && this.translate.currentLang && this.translate.instant) {
                    groupedHeaderTitle = this.translate.instant((columnDef.columnGroupKey || columnDef.columnGroupKey));
                }
                else {
                    groupedHeaderTitle = columnDef.columnGroup || '';
                }
                const skippedField = columnDef.excludeFromExport || false;
                // if column width is 0px, then we consider that field as a hidden field and should not be part of the export
                if ((columnDef.width === undefined || columnDef.width > 0) && !skippedField) {
                    groupedColumnHeaders.push({
                        key: (columnDef.field || columnDef.id),
                        title: groupedHeaderTitle || ''
                    });
                }
            });
        }
        return groupedColumnHeaders;
    }
    /**
     * Get all header titles and their keys, translate the title when required.
     * @param {Array<object>} columns of the grid
     */
    getColumnHeaders(columns) {
        const columnHeaders = [];
        if (columns && Array.isArray(columns)) {
            // Populate the Column Header, pull the name defined
            columns.forEach((columnDef) => {
                let headerTitle = '';
                if ((columnDef.headerKey || columnDef.nameKey) && this._gridOptions.enableTranslate && this.translate && this.translate.currentLang && this.translate.instant) {
                    headerTitle = this.translate.instant((columnDef.headerKey || columnDef.nameKey));
                }
                else {
                    headerTitle = columnDef.name || titleCase(columnDef.field);
                }
                const skippedField = columnDef.excludeFromExport || false;
                // if column width is 0, then we consider that field as a hidden field and should not be part of the export
                if ((columnDef.width === undefined || columnDef.width > 0) && !skippedField) {
                    columnHeaders.push({
                        key: columnDef.field || columnDef.id,
                        title: headerTitle
                    });
                }
            });
        }
        return columnHeaders;
    }
    /**
     * Get the data of a regular row (a row without grouping)
     * @param row
     * @param itemObj
     */
    readRegularRowData(columns, row, itemObj) {
        let idx = 0;
        const rowOutputStrings = [];
        const exportQuoteWrapper = this._exportQuoteWrapper;
        for (let col = 0, ln = columns.length; col < ln; col++) {
            const columnDef = columns[col];
            // skip excluded column
            if (columnDef.excludeFromExport) {
                continue;
            }
            // if we are grouping and are on 1st column index, we need to skip this column since it will be used later by the grouping text:: Group by [columnX]
            if (this._hasGroupedItems && idx === 0) {
                const emptyValue = this._fileFormat === FileType.csv ? `""` : '';
                rowOutputStrings.push(emptyValue);
            }
            // get the output by analyzing if we'll pull the value from the cell or from a formatter
            let itemData = exportWithFormatterWhenDefined(row, col, itemObj, columnDef, this._grid, this._exportOptions);
            // does the user want to sanitize the output data (remove HTML tags)?
            if (columnDef.sanitizeDataExport || this._exportOptions.sanitizeDataExport) {
                itemData = sanitizeHtmlToText(itemData);
            }
            // when CSV we also need to escape double quotes twice, so " becomes ""
            if (this._fileFormat === FileType.csv && itemData) {
                itemData = itemData.toString().replace(/"/gi, `""`);
            }
            // do we have a wrapper to keep as a string? in certain cases like "1E06", we don't want excel to transform it into exponential (1.0E06)
            // to cancel that effect we can had = in front, ex: ="1E06"
            const keepAsStringWrapper = (columnDef && columnDef.exportCsvForceToKeepAsString) ? '=' : '';
            rowOutputStrings.push(keepAsStringWrapper + exportQuoteWrapper + itemData + exportQuoteWrapper);
            idx++;
        }
        return rowOutputStrings.join(this._delimiter);
    }
    /**
     * Get the grouped title(s) and its group title formatter, for example if we grouped by salesRep, the returned result would be:: 'Sales Rep: John Dow (2 items)'
     * @param itemObj
     */
    readGroupedTitleRow(itemObj) {
        let groupName = sanitizeHtmlToText(itemObj.title);
        const exportQuoteWrapper = this._exportQuoteWrapper;
        groupName = addWhiteSpaces(5 * itemObj.level) + groupName;
        if (this._fileFormat === FileType.csv) {
            // when CSV we also need to escape double quotes twice, so " becomes ""
            groupName = groupName.toString().replace(/"/gi, `""`);
        }
        return exportQuoteWrapper + groupName + exportQuoteWrapper;
    }
    /**
     * Get the grouped totals (below the regular rows), these are set by Slick Aggregators.
     * For example if we grouped by "salesRep" and we have a Sum Aggregator on "sales", then the returned output would be:: ["Sum 123$"]
     * @param itemObj
     */
    readGroupedTotalRow(columns, itemObj) {
        const delimiter = this._exportOptions.delimiter;
        const format = this._exportOptions.format;
        const groupingAggregatorRowText = this._exportOptions.groupingAggregatorRowText || '';
        const exportQuoteWrapper = this._exportQuoteWrapper;
        const outputStrings = [`${exportQuoteWrapper}${groupingAggregatorRowText}${exportQuoteWrapper}`];
        columns.forEach((columnDef) => {
            let itemData = '';
            const skippedField = columnDef.excludeFromExport || false;
            // if there's a groupTotalsFormatter, we will re-run it to get the exact same output as what is shown in UI
            if (columnDef.groupTotalsFormatter) {
                itemData = columnDef.groupTotalsFormatter(itemObj, columnDef);
            }
            // does the user want to sanitize the output data (remove HTML tags)?
            if (columnDef.sanitizeDataExport || this._exportOptions.sanitizeDataExport) {
                itemData = sanitizeHtmlToText(itemData);
            }
            if (format === FileType.csv) {
                // when CSV we also need to escape double quotes twice, so a double quote " becomes 2x double quotes ""
                itemData = itemData.toString().replace(/"/gi, `""`);
            }
            // add the column (unless user wants to skip it)
            if ((columnDef.width === undefined || columnDef.width > 0) && !skippedField) {
                outputStrings.push(exportQuoteWrapper + itemData + exportQuoteWrapper);
            }
        });
        return outputStrings.join(delimiter);
    }
};
ExportService.ɵfac = function ExportService_Factory(t) { return new (t || ExportService)(ɵngcc0.ɵɵinject(ɵngcc1.TranslateService, 8)); };
ExportService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: ExportService, factory: ExportService.ɵfac });
ExportService.ctorParameters = () => [
    { type: TranslateService, decorators: [{ type: Optional }] }
];
ExportService = tslib_1.__decorate([ tslib_1.__param(0, Optional())
], ExportService);
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ExportService, [{
        type: Injectable
    }], function () { return [{ type: ɵngcc1.TranslateService, decorators: [{
                type: Optional
            }] }]; }, null); })();
export { ExportService };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhwb3J0LnNlcnZpY2UuanMiLCJzb3VyY2VzIjpbIm5nOi9hbmd1bGFyLXNsaWNrZ3JpZC9hcHAvbW9kdWxlcy9hbmd1bGFyLXNsaWNrZ3JpZC9zZXJ2aWNlcy9leHBvcnQuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDckQsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdkQsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFFL0IsT0FBTyxFQUdMLFFBQVEsR0FJVCxNQUFNLG1CQUFtQixDQUFDO0FBQzNCLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUMzQyxPQUFPLEVBQUUsOEJBQThCLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUNwRSxPQUFPLEVBQUUsY0FBYyxFQUFFLG9CQUFvQixFQUFFLGdCQUFnQixFQUFFLGtCQUFrQixFQUFFLFNBQVMsRUFBRSxNQUFNLHlCQUF5QixDQUFDOzs7QUFNaEksSUFBYSxhQUFhLEdBQTFCLE1BQWEsYUFBYTtBQUMxQixJQWNFLFlBQWdDLFNBQTJCO0FBQUksUUFBL0IsY0FBUyxHQUFULFNBQVMsQ0FBa0I7QUFBQyxRQWRwRCxlQUFVLEdBQUcsR0FBRyxDQUFDO0FBQzNCLFFBQVUsZ0JBQVcsR0FBRyxRQUFRLENBQUMsR0FBRyxDQUFDO0FBQ3JDLFFBQVUsd0JBQW1CLEdBQUcsSUFBSSxDQUFDO0FBQ3JDLFFBR1Usd0JBQW1CLEdBQUcsRUFBRSxDQUFDO0FBQ25DLFFBRVUscUJBQWdCLEdBQUcsS0FBSyxDQUFDO0FBQ25DLFFBQ0UsNkJBQXdCLEdBQUcsSUFBSSxPQUFPLEVBQVcsQ0FBQztBQUNwRCxRQUFFLDRCQUF1QixHQUFHLElBQUksT0FBTyxFQUFvRixD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QSxBQUdBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUtBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUVBLEFBUUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBS0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUVBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUVBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFFQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQ0EsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFHQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUdBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFJQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBR0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUlBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUVBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQTNYQSxBQUFBLEFBQUEsQUFBQSxBQWZBLEFBQUEsQUFEQSxBQUFBLEFBQUEsQUFnQkEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQWZBLEFBQUEsQUEwWUEsQUExWUEsQUFBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUsIE9wdGlvbmFsIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBUcmFuc2xhdGVTZXJ2aWNlIH0gZnJvbSAnQG5neC10cmFuc2xhdGUvY29yZSc7XG5pbXBvcnQgeyBUZXh0RW5jb2RlciB9IGZyb20gJ3RleHQtZW5jb2RpbmctdXRmLTgnO1xuaW1wb3J0IHsgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xuXG5pbXBvcnQge1xuICBDb2x1bW4sXG4gIEV4cG9ydE9wdGlvbixcbiAgRmlsZVR5cGUsXG4gIEdyaWRPcHRpb24sXG4gIEtleVRpdGxlUGFpcixcbiAgTG9jYWxlLFxufSBmcm9tICcuLy4uL21vZGVscy9pbmRleCc7XG5pbXBvcnQgeyBDb25zdGFudHMgfSBmcm9tICcuLy4uL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBleHBvcnRXaXRoRm9ybWF0dGVyV2hlbkRlZmluZWQgfSBmcm9tICcuL2V4cG9ydC11dGlsaXRpZXMnO1xuaW1wb3J0IHsgYWRkV2hpdGVTcGFjZXMsIGdldFRyYW5zbGF0aW9uUHJlZml4LCBodG1sRW50aXR5RGVjb2RlLCBzYW5pdGl6ZUh0bWxUb1RleHQsIHRpdGxlQ2FzZSB9IGZyb20gJy4vLi4vc2VydmljZXMvdXRpbGl0aWVzJztcblxuLy8gdXNpbmcgZXh0ZXJuYWwgbm9uLXR5cGVkIGpzIGxpYnJhcmllc1xuZGVjbGFyZSBsZXQgJDogYW55O1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgRXhwb3J0U2VydmljZSB7XG4gIHByaXZhdGUgX2RlbGltaXRlciA9ICcsJztcbiAgcHJpdmF0ZSBfZmlsZUZvcm1hdCA9IEZpbGVUeXBlLmNzdjtcbiAgcHJpdmF0ZSBfbGluZUNhcnJpYWdlUmV0dXJuID0gJ1xcbic7XG4gIHByaXZhdGUgX2RhdGFWaWV3OiBhbnk7XG4gIHByaXZhdGUgX2dyaWQ6IGFueTtcbiAgcHJpdmF0ZSBfbG9jYWxlczogTG9jYWxlO1xuICBwcml2YXRlIF9leHBvcnRRdW90ZVdyYXBwZXIgPSAnJztcbiAgcHJpdmF0ZSBfY29sdW1uSGVhZGVyczogS2V5VGl0bGVQYWlyW107XG4gIHByaXZhdGUgX2dyb3VwZWRDb2x1bW5IZWFkZXJzOiBLZXlUaXRsZVBhaXJbXTtcbiAgcHJpdmF0ZSBfaGFzR3JvdXBlZEl0ZW1zID0gZmFsc2U7XG4gIHByaXZhdGUgX2V4cG9ydE9wdGlvbnM6IEV4cG9ydE9wdGlvbjtcbiAgb25HcmlkQmVmb3JlRXhwb3J0VG9GaWxlID0gbmV3IFN1YmplY3Q8Ym9vbGVhbj4oKTtcbiAgb25HcmlkQWZ0ZXJFeHBvcnRUb0ZpbGUgPSBuZXcgU3ViamVjdDx7IGNvbnRlbnQ/OiBzdHJpbmc7IGZpbGVuYW1lOiBzdHJpbmc7IGZvcm1hdDogc3RyaW5nOyB1c2VVdGY4V2l0aEJvbTogYm9vbGVhbjsgfT4oKTtcblxuICBjb25zdHJ1Y3RvcihAT3B0aW9uYWwoKSBwcml2YXRlIHRyYW5zbGF0ZTogVHJhbnNsYXRlU2VydmljZSkgeyB9XG5cbiAgcHJpdmF0ZSBnZXQgZGF0YXNldElkTmFtZSgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLl9ncmlkT3B0aW9ucyAmJiB0aGlzLl9ncmlkT3B0aW9ucy5kYXRhc2V0SWRQcm9wZXJ0eU5hbWUgfHwgJ2lkJztcbiAgfVxuXG4gIC8qKiBHZXR0ZXIgZm9yIHRoZSBHcmlkIE9wdGlvbnMgcHVsbGVkIHRocm91Z2ggdGhlIEdyaWQgT2JqZWN0ICovXG4gIHByaXZhdGUgZ2V0IF9ncmlkT3B0aW9ucygpOiBHcmlkT3B0aW9uIHtcbiAgICByZXR1cm4gKHRoaXMuX2dyaWQgJiYgdGhpcy5fZ3JpZC5nZXRPcHRpb25zKSA/IHRoaXMuX2dyaWQuZ2V0T3B0aW9ucygpIDoge307XG4gIH1cblxuICAvKipcbiAgICogSW5pdGlhbGl6ZSB0aGUgRXhwb3J0IFNlcnZpY2VcbiAgICogQHBhcmFtIGdyaWRcbiAgICogQHBhcmFtIGdyaWRPcHRpb25zXG4gICAqIEBwYXJhbSBkYXRhVmlld1xuICAgKi9cbiAgaW5pdChncmlkOiBhbnksIGRhdGFWaWV3OiBhbnkpOiB2b2lkIHtcbiAgICB0aGlzLl9ncmlkID0gZ3JpZDtcbiAgICB0aGlzLl9kYXRhVmlldyA9IGRhdGFWaWV3O1xuXG4gICAgLy8gZ2V0IGxvY2FsZXMgcHJvdmlkZWQgYnkgdXNlciBpbiBmb3JSb290IG9yIGVsc2UgdXNlIGRlZmF1bHQgRW5nbGlzaCBsb2NhbGVzIHZpYSB0aGUgQ29uc3RhbnRzXG4gICAgdGhpcy5fbG9jYWxlcyA9IHRoaXMuX2dyaWRPcHRpb25zICYmIHRoaXMuX2dyaWRPcHRpb25zLmxvY2FsZXMgfHwgQ29uc3RhbnRzLmxvY2FsZXM7XG5cbiAgICBpZiAodGhpcy5fZ3JpZE9wdGlvbnMuZW5hYmxlVHJhbnNsYXRlICYmICghdGhpcy50cmFuc2xhdGUgfHwgIXRoaXMudHJhbnNsYXRlLmluc3RhbnQpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1tBbmd1bGFyLVNsaWNrZ3JpZF0gcmVxdWlyZXMgXCJuZ3gtdHJhbnNsYXRlXCIgdG8gYmUgaW5zdGFsbGVkIGFuZCBjb25maWd1cmVkIHdoZW4gdGhlIGdyaWQgb3B0aW9uIFwiZW5hYmxlVHJhbnNsYXRlXCIgaXMgZW5hYmxlZC4nKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRnVuY3Rpb24gdG8gZXhwb3J0IHRoZSBHcmlkIHJlc3VsdCB0byBhbiBFeGNlbCBDU1YgZm9ybWF0IHVzaW5nIGphdmFzY3JpcHQgZm9yIGl0IHRvIHByb2R1Y2UgdGhlIENTViBmaWxlLlxuICAgKiBUaGlzIGlzIGEgV1lTSVdZRyBleHBvcnQgdG8gZmlsZSBvdXRwdXQgKFdoYXQgWW91IFNlZSBpcyBXaGF0IFlvdSBHZXQpXG4gICAqXG4gICAqIE5PVEVTOiBUaGUgY29sdW1uIHBvc2l0aW9uIG5lZWRzIHRvIG1hdGNoIHBlcmZlY3RseSB0aGUgSlNPTiBPYmplY3QgcG9zaXRpb24gYmVjYXVzZSBvZiB0aGUgd2F5IHdlIGFyZSBwdWxsaW5nIHRoZSBkYXRhLFxuICAgKiB3aGljaCBtZWFucyB0aGF0IGlmIGFueSBjb2x1bW4ocykgZ290IG1vdmVkIGluIHRoZSBVSSwgaXQgaGFzIHRvIGJlIHJlZmxlY3RlZCBpbiB0aGUgSlNPTiBhcnJheSBvdXRwdXQgYXMgd2VsbFxuICAgKlxuICAgKiBFeGFtcGxlOiBleHBvcnRUb0ZpbGUoeyBmb3JtYXQ6IEZpbGVUeXBlLmNzdiwgZGVsaW1pdGVyOiBEZWxpbWl0ZXJUeXBlLmNvbW1hIH0pXG4gICAqL1xuICBleHBvcnRUb0ZpbGUob3B0aW9uczogRXhwb3J0T3B0aW9uKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgaWYgKCF0aGlzLl9ncmlkIHx8ICF0aGlzLl9kYXRhVmlldykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdbQW5ndWxhci1TbGlja2dyaWRdIGl0IHNlZW1zIHRoYXQgdGhlIFNsaWNrR3JpZCAmIERhdGFWaWV3IG9iamVjdHMgYXJlIG5vdCBpbml0aWFsaXplZCBkaWQgeW91IGZvcmdldCB0byBlbmFibGUgdGhlIGdyaWQgb3B0aW9uIGZsYWcgXCJlbmFibGVFeGNlbEV4cG9ydFwiPycpO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICB0aGlzLm9uR3JpZEJlZm9yZUV4cG9ydFRvRmlsZS5uZXh0KHRydWUpO1xuICAgICAgdGhpcy5fZXhwb3J0T3B0aW9ucyA9ICQuZXh0ZW5kKHRydWUsIHt9LCB0aGlzLl9ncmlkT3B0aW9ucy5leHBvcnRPcHRpb25zLCBvcHRpb25zKTtcbiAgICAgIHRoaXMuX2RlbGltaXRlciA9IHRoaXMuX2V4cG9ydE9wdGlvbnMuZGVsaW1pdGVyT3ZlcnJpZGUgfHwgdGhpcy5fZXhwb3J0T3B0aW9ucy5kZWxpbWl0ZXIgfHwgJyc7XG4gICAgICB0aGlzLl9maWxlRm9ybWF0ID0gdGhpcy5fZXhwb3J0T3B0aW9ucy5mb3JtYXQgfHwgRmlsZVR5cGUuY3N2O1xuXG4gICAgICAvLyBnZXQgdGhlIENTViBvdXRwdXQgZnJvbSB0aGUgZ3JpZCBkYXRhXG4gICAgICBjb25zdCBkYXRhT3V0cHV0ID0gdGhpcy5nZXREYXRhT3V0cHV0KCk7XG5cbiAgICAgIC8vIHRyaWdnZXIgYSBkb3dubG9hZCBmaWxlXG4gICAgICAvLyB3cmFwIGl0IGludG8gYSBzZXRUaW1lb3V0IHNvIHRoYXQgdGhlIEV2ZW50QWdncmVnYXRvciBoYXMgZW5vdWdoIHRpbWUgdG8gc3RhcnQgYSBwcmUtcHJvY2VzcyBsaWtlIHNob3dpbmcgYSBzcGlubmVyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBkb3dubG9hZE9wdGlvbnMgPSB7XG4gICAgICAgICAgICBmaWxlbmFtZTogYCR7dGhpcy5fZXhwb3J0T3B0aW9ucy5maWxlbmFtZX0uJHt0aGlzLl9maWxlRm9ybWF0fWAsXG4gICAgICAgICAgICBmb3JtYXQ6IHRoaXMuX2ZpbGVGb3JtYXQsXG4gICAgICAgICAgICB1c2VVdGY4V2l0aEJvbTogdGhpcy5fZXhwb3J0T3B0aW9ucy5oYXNPd25Qcm9wZXJ0eSgndXNlVXRmOFdpdGhCb20nKSA/IHRoaXMuX2V4cG9ydE9wdGlvbnMudXNlVXRmOFdpdGhCb20gOiB0cnVlXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIC8vIHN0YXJ0IGRvd25sb2FkaW5nIGJ1dCBhZGQgdGhlIGNvbnRlbnQgcHJvcGVydHkgb25seSBvbiB0aGUgc3RhcnQgZG93bmxvYWQgbm90IG9uIHRoZSBldmVudCBpdHNlbGZcbiAgICAgICAgICB0aGlzLnN0YXJ0RG93bmxvYWRGaWxlKHsgLi4uZG93bmxvYWRPcHRpb25zLCBjb250ZW50OiBkYXRhT3V0cHV0IH0pOyAvLyBhZGQgY29udGVudCBwcm9wZXJ0eVxuICAgICAgICAgIHRoaXMub25HcmlkQWZ0ZXJFeHBvcnRUb0ZpbGUubmV4dChkb3dubG9hZE9wdGlvbnMpO1xuICAgICAgICAgIHJlc29sdmUodHJ1ZSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfSwgMCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogVHJpZ2dlcnMgZG93bmxvYWQgZmlsZSB3aXRoIGZpbGUgZm9ybWF0LlxuICAgKiBJRSg2LTEwKSBhcmUgbm90IHN1cHBvcnRlZFxuICAgKiBBbGwgb3RoZXIgYnJvd3NlcnMgd2lsbCB1c2UgcGxhaW4gamF2YXNjcmlwdCBvbiBjbGllbnQgc2lkZSB0byBwcm9kdWNlIGEgZmlsZSBkb3dubG9hZC5cbiAgICogQHBhcmFtIG9wdGlvbnNcbiAgICovXG4gIHN0YXJ0RG93bmxvYWRGaWxlKG9wdGlvbnM6IHsgZmlsZW5hbWU6IHN0cmluZywgY29udGVudDogc3RyaW5nLCBmb3JtYXQ6IEZpbGVUeXBlIHwgc3RyaW5nLCB1c2VVdGY4V2l0aEJvbTogYm9vbGVhbiB9KSB7XG4gICAgLy8gSUUoNi0xMCkgZG9uJ3Qgc3VwcG9ydCBqYXZhc2NyaXB0IGRvd25sb2FkIGFuZCBvdXIgc2VydmljZSBkb2Vzbid0IHN1cHBvcnQgZWl0aGVyIHNvIHRocm93IGFuIGVycm9yLCB3ZSBoYXZlIHRvIG1ha2UgYSByb3VuZCB0cmlwIHRvIHRoZSBXZWIgU2VydmVyIGZvciBleHBvcnRpbmdcbiAgICBpZiAobmF2aWdhdG9yLmFwcE5hbWUgPT09ICdNaWNyb3NvZnQgSW50ZXJuZXQgRXhwbG9yZXInKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pY3Jvc29mdCBJbnRlcm5ldCBFeHBsb3JlciA2IHRvIDEwIGRvIG5vdCBzdXBwb3J0IGphdmFzY3JpcHQgZXhwb3J0IHRvIENTVi4gUGxlYXNlIHVwZ3JhZGUgeW91ciBicm93c2VyLicpO1xuICAgIH1cblxuICAgIC8vIHNldCB0aGUgY29ycmVjdCBNSU1FIHR5cGVcbiAgICBjb25zdCBtaW1lVHlwZSA9IChvcHRpb25zLmZvcm1hdCA9PT0gRmlsZVR5cGUuY3N2KSA/ICd0ZXh0L2NzdicgOiAndGV4dC9wbGFpbic7XG5cbiAgICAvLyBtYWtlIHN1cmUgbm8gaHRtbCBlbnRpdGllcyBleGlzdCBpbiB0aGUgZGF0YVxuICAgIGNvbnN0IGRhdGFDb250ZW50ID0gaHRtbEVudGl0eURlY29kZShvcHRpb25zLmNvbnRlbnQpO1xuXG4gICAgLy8gZGVhbGluZyB3aXRoIEV4Y2VsIENTViBleHBvcnQgYW5kIFVURi04IGlzIGEgbGl0dGxlIHRyaWNreS4uIFdlIHdpbGwgdXNlIE9wdGlvbiAjMiB0byBjb3ZlciBvbGRlciBFeGNlbCB2ZXJzaW9uc1xuICAgIC8vIE9wdGlvbiAjMTogd2UgbmVlZCB0byBtYWtlIEV4Y2VsIGtub3dpbmcgdGhhdCBpdCdzIGRlYWxpbmcgd2l0aCBhbiBVVEYtOCwgQSBjb3JyZWN0bHkgZm9ybWF0dGVkIFVURjggZmlsZSBjYW4gaGF2ZSBhIEJ5dGUgT3JkZXIgTWFyayBhcyBpdHMgZmlyc3QgdGhyZWUgb2N0ZXRzXG4gICAgLy8gcmVmZXJlbmNlOiBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzE1NTA5Ny9taWNyb3NvZnQtZXhjZWwtbWFuZ2xlcy1kaWFjcml0aWNzLWluLWNzdi1maWxlc1xuICAgIC8vIE9wdGlvbiMyOiB1c2UgYSAzcmQgcGFydHkgZXh0ZW5zaW9uIHRvIGphdmFzY3JpcHQgZW5jb2RlIGludG8gVVRGLTE2XG4gICAgbGV0IG91dHB1dERhdGE6IFVpbnQ4QXJyYXkgfCBzdHJpbmc7XG4gICAgaWYgKG9wdGlvbnMuZm9ybWF0ID09PSBGaWxlVHlwZS5jc3YpIHtcbiAgICAgIG91dHB1dERhdGEgPSBuZXcgVGV4dEVuY29kZXIoJ3V0Zi04JykuZW5jb2RlKGRhdGFDb250ZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgb3V0cHV0RGF0YSA9IGRhdGFDb250ZW50O1xuICAgIH1cblxuICAgIC8vIGNyZWF0ZSBhIEJsb2Igb2JqZWN0IGZvciB0aGUgZG93bmxvYWRcbiAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW29wdGlvbnMudXNlVXRmOFdpdGhCb20gPyAnXFx1RkVGRicgOiAnJywgb3V0cHV0RGF0YV0sIHtcbiAgICAgIHR5cGU6IGAke21pbWVUeXBlfTtjaGFyc2V0PXV0Zi04O2BcbiAgICB9KTtcblxuICAgIC8vIHdoZW4gdXNpbmcgSUUvRWRnZSwgdGhlbiB1c2UgZGlmZmVyZW50IGRvd25sb2FkIGNhbGxcbiAgICBpZiAodHlwZW9mIG5hdmlnYXRvci5tc1NhdmVPck9wZW5CbG9iID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBuYXZpZ2F0b3IubXNTYXZlT3JPcGVuQmxvYihibG9iLCBvcHRpb25zLmZpbGVuYW1lKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gdGhpcyB0cmljayB3aWxsIGdlbmVyYXRlIGEgdGVtcCA8YSAvPiB0YWdcbiAgICAgIC8vIHRoZSBjb2RlIHdpbGwgdGhlbiB0cmlnZ2VyIGEgaGlkZGVuIGNsaWNrIGZvciBpdCB0byBzdGFydCBkb3dubG9hZGluZ1xuICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICAgIGNvbnN0IGNzdlVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG5cbiAgICAgIGxpbmsudGV4dENvbnRlbnQgPSAnZG93bmxvYWQnO1xuICAgICAgbGluay5ocmVmID0gY3N2VXJsO1xuICAgICAgbGluay5zZXRBdHRyaWJ1dGUoJ2Rvd25sb2FkJywgb3B0aW9ucy5maWxlbmFtZSk7XG5cbiAgICAgIC8vIHNldCB0aGUgdmlzaWJpbGl0eSB0byBoaWRkZW4gc28gdGhlcmUgaXMgbm8gZWZmZWN0IG9uIHlvdXIgd2ViLWxheW91dFxuICAgICAgbGluay5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG5cbiAgICAgIC8vIHRoaXMgcGFydCB3aWxsIGFwcGVuZCB0aGUgYW5jaG9yIHRhZywgdHJpZ2dlciBhIGNsaWNrIChmb3IgZG93bmxvYWQgdG8gc3RhcnQpIGFuZCBmaW5hbGx5IHJlbW92ZSB0aGUgdGFnIG9uY2UgY29tcGxldGVkXG4gICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpbmspO1xuICAgICAgbGluay5jbGljaygpO1xuICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChsaW5rKTtcbiAgICB9XG4gIH1cblxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAvLyBQcml2YXRlIGZ1bmN0aW9uc1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIHByaXZhdGUgZ2V0RGF0YU91dHB1dCgpOiBzdHJpbmcge1xuICAgIGNvbnN0IGNvbHVtbnMgPSB0aGlzLl9ncmlkLmdldENvbHVtbnMoKSB8fCBbXTtcblxuICAgIC8vIEdyb3VwIEJ5IHRleHQsIGl0IGNvdWxkIGJlIHNldCBpbiB0aGUgZXhwb3J0IG9wdGlvbnMgb3IgZnJvbSB0cmFuc2xhdGlvbiBvciBpZiBub3RoaW5nIGlzIGZvdW5kIHRoZW4gdXNlIHRoZSBFbmdsaXNoIGNvbnN0YW50IHRleHRcbiAgICBsZXQgZ3JvdXBCeUNvbHVtbkhlYWRlciA9IHRoaXMuX2V4cG9ydE9wdGlvbnMuZ3JvdXBpbmdDb2x1bW5IZWFkZXJUaXRsZTtcbiAgICBpZiAoIWdyb3VwQnlDb2x1bW5IZWFkZXIgJiYgdGhpcy5fZ3JpZE9wdGlvbnMuZW5hYmxlVHJhbnNsYXRlICYmIHRoaXMudHJhbnNsYXRlICYmIHRoaXMudHJhbnNsYXRlLmN1cnJlbnRMYW5nICYmIHRoaXMudHJhbnNsYXRlLmluc3RhbnQpIHtcbiAgICAgIGdyb3VwQnlDb2x1bW5IZWFkZXIgPSB0aGlzLnRyYW5zbGF0ZS5pbnN0YW50KGAke2dldFRyYW5zbGF0aW9uUHJlZml4KHRoaXMuX2dyaWRPcHRpb25zKX1HUk9VUF9CWWApO1xuICAgIH0gZWxzZSBpZiAoIWdyb3VwQnlDb2x1bW5IZWFkZXIpIHtcbiAgICAgIGdyb3VwQnlDb2x1bW5IZWFkZXIgPSB0aGlzLl9sb2NhbGVzICYmIHRoaXMuX2xvY2FsZXMuVEVYVF9HUk9VUF9CWTtcbiAgICB9XG5cbiAgICAvLyBhIENTViBuZWVkcyBkb3VibGUgcXVvdGVzIHdyYXBwZXIsIHRoZSBvdGhlciB0eXBlcyBkbyBub3QgbmVlZCBhbnkgd3JhcHBlclxuICAgIHRoaXMuX2V4cG9ydFF1b3RlV3JhcHBlciA9ICh0aGlzLl9maWxlRm9ybWF0ID09PSBGaWxlVHlwZS5jc3YpID8gJ1wiJyA6ICcnO1xuXG4gICAgLy8gZGF0YSB2YXJpYWJsZSB3aGljaCB3aWxsIGhvbGQgYWxsIHRoZSBmaWVsZHMgZGF0YSBvZiBhIHJvd1xuICAgIGxldCBvdXRwdXREYXRhU3RyaW5nID0gJyc7XG5cbiAgICAvLyBnZXQgZ3JvdXBlZCBjb2x1bW4gdGl0bGVzIGFuZCBpZiBmb3VuZCwgd2Ugd2lsbCBhZGQgYSBcIkdyb3VwIGJ5XCIgY29sdW1uIGF0IHRoZSBmaXJzdCBjb2x1bW4gaW5kZXhcbiAgICAvLyBpZiBpdCdzIGEgQ1NWIGZvcm1hdCwgd2UnbGwgZXNjYXBlIHRoZSB0ZXh0IGluIGRvdWJsZSBxdW90ZXNcbiAgICBjb25zdCBncm91cGluZyA9IHRoaXMuX2RhdGFWaWV3LmdldEdyb3VwaW5nKCk7XG4gICAgaWYgKGdyb3VwaW5nICYmIEFycmF5LmlzQXJyYXkoZ3JvdXBpbmcpICYmIGdyb3VwaW5nLmxlbmd0aCA+IDApIHtcbiAgICAgIHRoaXMuX2hhc0dyb3VwZWRJdGVtcyA9IHRydWU7XG4gICAgICBvdXRwdXREYXRhU3RyaW5nICs9ICh0aGlzLl9maWxlRm9ybWF0ID09PSBGaWxlVHlwZS5jc3YpID8gYFwiJHtncm91cEJ5Q29sdW1uSGVhZGVyfVwiJHt0aGlzLl9kZWxpbWl0ZXJ9YCA6IGAke2dyb3VwQnlDb2x1bW5IZWFkZXJ9JHt0aGlzLl9kZWxpbWl0ZXJ9YDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGFzR3JvdXBlZEl0ZW1zID0gZmFsc2U7XG4gICAgfVxuXG4gICAgLy8gZ2V0IGFsbCBHcm91cGVkIENvbHVtbiBIZWFkZXIgVGl0bGVzIHdoZW4gZGVmaW5lZCAoZnJvbSBwcmUtaGVhZGVyIHJvdylcbiAgICBpZiAodGhpcy5fZ3JpZE9wdGlvbnMuY3JlYXRlUHJlSGVhZGVyUGFuZWwgJiYgdGhpcy5fZ3JpZE9wdGlvbnMuc2hvd1ByZUhlYWRlclBhbmVsICYmICF0aGlzLl9ncmlkT3B0aW9ucy5lbmFibGVEcmFnZ2FibGVHcm91cGluZykge1xuICAgICAgdGhpcy5fZ3JvdXBlZENvbHVtbkhlYWRlcnMgPSB0aGlzLmdldENvbHVtbkdyb3VwZWRIZWFkZXJUaXRsZXMoY29sdW1ucykgfHwgW107XG4gICAgICBpZiAodGhpcy5fZ3JvdXBlZENvbHVtbkhlYWRlcnMgJiYgQXJyYXkuaXNBcnJheSh0aGlzLl9ncm91cGVkQ29sdW1uSGVhZGVycykgJiYgdGhpcy5fZ3JvdXBlZENvbHVtbkhlYWRlcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAvLyBhZGQgdGhlIGhlYWRlciByb3cgKyBhZGQgYSBuZXcgbGluZSBhdCB0aGUgZW5kIG9mIHRoZSByb3dcbiAgICAgICAgY29uc3Qgb3V0cHV0R3JvdXBlZEhlYWRlclRpdGxlcyA9IHRoaXMuX2dyb3VwZWRDb2x1bW5IZWFkZXJzLm1hcCgoaGVhZGVyKSA9PiBgJHt0aGlzLl9leHBvcnRRdW90ZVdyYXBwZXJ9JHtoZWFkZXIudGl0bGV9JHt0aGlzLl9leHBvcnRRdW90ZVdyYXBwZXJ9YCk7XG4gICAgICAgIG91dHB1dERhdGFTdHJpbmcgKz0gKG91dHB1dEdyb3VwZWRIZWFkZXJUaXRsZXMuam9pbih0aGlzLl9kZWxpbWl0ZXIpICsgdGhpcy5fbGluZUNhcnJpYWdlUmV0dXJuKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBnZXQgYWxsIENvbHVtbiBIZWFkZXIgVGl0bGVzXG4gICAgdGhpcy5fY29sdW1uSGVhZGVycyA9IHRoaXMuZ2V0Q29sdW1uSGVhZGVycyhjb2x1bW5zKSB8fCBbXTtcbiAgICBpZiAodGhpcy5fY29sdW1uSGVhZGVycyAmJiBBcnJheS5pc0FycmF5KHRoaXMuX2NvbHVtbkhlYWRlcnMpICYmIHRoaXMuX2NvbHVtbkhlYWRlcnMubGVuZ3RoID4gMCkge1xuICAgICAgLy8gYWRkIHRoZSBoZWFkZXIgcm93ICsgYWRkIGEgbmV3IGxpbmUgYXQgdGhlIGVuZCBvZiB0aGUgcm93XG4gICAgICBjb25zdCBvdXRwdXRIZWFkZXJUaXRsZXMgPSB0aGlzLl9jb2x1bW5IZWFkZXJzLm1hcCgoaGVhZGVyKSA9PiBgJHt0aGlzLl9leHBvcnRRdW90ZVdyYXBwZXJ9JHtoZWFkZXIudGl0bGV9JHt0aGlzLl9leHBvcnRRdW90ZVdyYXBwZXJ9YCk7XG4gICAgICBvdXRwdXREYXRhU3RyaW5nICs9IChvdXRwdXRIZWFkZXJUaXRsZXMuam9pbih0aGlzLl9kZWxpbWl0ZXIpICsgdGhpcy5fbGluZUNhcnJpYWdlUmV0dXJuKTtcbiAgICB9XG5cbiAgICAvLyBQb3B1bGF0ZSB0aGUgcmVzdCBvZiB0aGUgR3JpZCBEYXRhXG4gICAgb3V0cHV0RGF0YVN0cmluZyArPSB0aGlzLmdldEFsbEdyaWRSb3dEYXRhKGNvbHVtbnMsIHRoaXMuX2xpbmVDYXJyaWFnZVJldHVybik7XG5cbiAgICByZXR1cm4gb3V0cHV0RGF0YVN0cmluZztcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYWxsIHRoZSBncmlkIHJvdyBkYXRhIGFuZCByZXR1cm4gdGhhdCBhcyBhbiBvdXRwdXQgc3RyaW5nXG4gICAqL1xuICBwcml2YXRlIGdldEFsbEdyaWRSb3dEYXRhKGNvbHVtbnM6IENvbHVtbltdLCBsaW5lQ2FycmlhZ2VSZXR1cm46IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3Qgb3V0cHV0RGF0YVN0cmluZ3MgPSBbXTtcbiAgICBjb25zdCBsaW5lQ291bnQgPSB0aGlzLl9kYXRhVmlldy5nZXRMZW5ndGgoKTtcblxuICAgIC8vIGxvb3AgdGhyb3VnaCBhbGwgdGhlIGdyaWQgcm93cyBvZiBkYXRhXG4gICAgZm9yIChsZXQgcm93TnVtYmVyID0gMDsgcm93TnVtYmVyIDwgbGluZUNvdW50OyByb3dOdW1iZXIrKykge1xuICAgICAgY29uc3QgaXRlbU9iaiA9IHRoaXMuX2RhdGFWaWV3LmdldEl0ZW0ocm93TnVtYmVyKTtcbiAgICAgIGlmIChpdGVtT2JqKSB7XG4gICAgICAgIC8vIE5vcm1hbCByb3cgKG5vdCBncm91cGVkIGJ5IGFueXRoaW5nKSB3b3VsZCBoYXZlIGFuIElEIHdoaWNoIHdhcyBwcmVkZWZpbmVkIGluIHRoZSBHcmlkIENvbHVtbnMgZGVmaW5pdGlvblxuICAgICAgICBpZiAoaXRlbU9ialt0aGlzLmRhdGFzZXRJZE5hbWVdICE9PSBudWxsICYmIGl0ZW1PYmpbdGhpcy5kYXRhc2V0SWROYW1lXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgLy8gZ2V0IHJlZ3VsYXIgcm93IGl0ZW0gZGF0YVxuICAgICAgICAgIG91dHB1dERhdGFTdHJpbmdzLnB1c2godGhpcy5yZWFkUmVndWxhclJvd0RhdGEoY29sdW1ucywgcm93TnVtYmVyLCBpdGVtT2JqKSk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5faGFzR3JvdXBlZEl0ZW1zICYmIGl0ZW1PYmouX19ncm91cFRvdGFscyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgLy8gZ2V0IHRoZSBncm91cCByb3dcbiAgICAgICAgICBvdXRwdXREYXRhU3RyaW5ncy5wdXNoKHRoaXMucmVhZEdyb3VwZWRUaXRsZVJvdyhpdGVtT2JqKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoaXRlbU9iai5fX2dyb3VwVG90YWxzKSB7XG4gICAgICAgICAgLy8gZWxzZSBpZiB0aGUgcm93IGlzIGEgR3JvdXAgQnkgYW5kIHdlIGhhdmUgYWdyZWdnYXRvcnMsIHRoZW4gYSBwcm9wZXJ0eSBvZiAnX19ncm91cFRvdGFscycgd291bGQgZXhpc3QgdW5kZXIgdGhhdCBvYmplY3RcbiAgICAgICAgICBvdXRwdXREYXRhU3RyaW5ncy5wdXNoKHRoaXMucmVhZEdyb3VwZWRUb3RhbFJvdyhjb2x1bW5zLCBpdGVtT2JqKSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gb3V0cHV0RGF0YVN0cmluZ3Muam9pbihsaW5lQ2FycmlhZ2VSZXR1cm4pO1xuICB9XG5cbiAgLyoqXG4gKiBHZXQgYWxsIEdyb3VwZWQgSGVhZGVyIFRpdGxlcyBhbmQgdGhlaXIga2V5cywgdHJhbnNsYXRlIHRoZSB0aXRsZSB3aGVuIHJlcXVpcmVkLlxuICogQHBhcmFtIHtBcnJheTxvYmplY3Q+fSBjb2x1bW5zIG9mIHRoZSBncmlkXG4gKi9cbiAgcHJpdmF0ZSBnZXRDb2x1bW5Hcm91cGVkSGVhZGVyVGl0bGVzKGNvbHVtbnM6IENvbHVtbltdKTogS2V5VGl0bGVQYWlyW10ge1xuICAgIGNvbnN0IGdyb3VwZWRDb2x1bW5IZWFkZXJzOiBLZXlUaXRsZVBhaXJbXSA9IFtdO1xuXG4gICAgaWYgKGNvbHVtbnMgJiYgQXJyYXkuaXNBcnJheShjb2x1bW5zKSkge1xuICAgICAgLy8gUG9wdWxhdGUgdGhlIEdyb3VwZWQgQ29sdW1uIEhlYWRlciwgcHVsbCB0aGUgY29sdW1uR3JvdXAoS2V5KSBkZWZpbmVkXG4gICAgICBjb2x1bW5zLmZvckVhY2goKGNvbHVtbkRlZikgPT4ge1xuICAgICAgICBsZXQgZ3JvdXBlZEhlYWRlclRpdGxlID0gJyc7XG4gICAgICAgIGlmICgoY29sdW1uRGVmLmNvbHVtbkdyb3VwS2V5IHx8IGNvbHVtbkRlZi5jb2x1bW5Hcm91cEtleSkgJiYgdGhpcy5fZ3JpZE9wdGlvbnMuZW5hYmxlVHJhbnNsYXRlICYmIHRoaXMudHJhbnNsYXRlICYmIHRoaXMudHJhbnNsYXRlLmN1cnJlbnRMYW5nICYmIHRoaXMudHJhbnNsYXRlLmluc3RhbnQpIHtcbiAgICAgICAgICBncm91cGVkSGVhZGVyVGl0bGUgPSB0aGlzLnRyYW5zbGF0ZS5pbnN0YW50KChjb2x1bW5EZWYuY29sdW1uR3JvdXBLZXkgfHwgY29sdW1uRGVmLmNvbHVtbkdyb3VwS2V5KSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZ3JvdXBlZEhlYWRlclRpdGxlID0gY29sdW1uRGVmLmNvbHVtbkdyb3VwIHx8ICcnO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHNraXBwZWRGaWVsZCA9IGNvbHVtbkRlZi5leGNsdWRlRnJvbUV4cG9ydCB8fCBmYWxzZTtcblxuICAgICAgICAvLyBpZiBjb2x1bW4gd2lkdGggaXMgMHB4LCB0aGVuIHdlIGNvbnNpZGVyIHRoYXQgZmllbGQgYXMgYSBoaWRkZW4gZmllbGQgYW5kIHNob3VsZCBub3QgYmUgcGFydCBvZiB0aGUgZXhwb3J0XG4gICAgICAgIGlmICgoY29sdW1uRGVmLndpZHRoID09PSB1bmRlZmluZWQgfHwgY29sdW1uRGVmLndpZHRoID4gMCkgJiYgIXNraXBwZWRGaWVsZCkge1xuICAgICAgICAgIGdyb3VwZWRDb2x1bW5IZWFkZXJzLnB1c2goe1xuICAgICAgICAgICAga2V5OiAoY29sdW1uRGVmLmZpZWxkIHx8IGNvbHVtbkRlZi5pZCkgYXMgc3RyaW5nLFxuICAgICAgICAgICAgdGl0bGU6IGdyb3VwZWRIZWFkZXJUaXRsZSB8fCAnJ1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGdyb3VwZWRDb2x1bW5IZWFkZXJzO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhbGwgaGVhZGVyIHRpdGxlcyBhbmQgdGhlaXIga2V5cywgdHJhbnNsYXRlIHRoZSB0aXRsZSB3aGVuIHJlcXVpcmVkLlxuICAgKiBAcGFyYW0ge0FycmF5PG9iamVjdD59IGNvbHVtbnMgb2YgdGhlIGdyaWRcbiAgICovXG4gIHByaXZhdGUgZ2V0Q29sdW1uSGVhZGVycyhjb2x1bW5zOiBDb2x1bW5bXSk6IEtleVRpdGxlUGFpcltdIHtcbiAgICBjb25zdCBjb2x1bW5IZWFkZXJzID0gW107XG5cbiAgICBpZiAoY29sdW1ucyAmJiBBcnJheS5pc0FycmF5KGNvbHVtbnMpKSB7XG4gICAgICAvLyBQb3B1bGF0ZSB0aGUgQ29sdW1uIEhlYWRlciwgcHVsbCB0aGUgbmFtZSBkZWZpbmVkXG4gICAgICBjb2x1bW5zLmZvckVhY2goKGNvbHVtbkRlZikgPT4ge1xuICAgICAgICBsZXQgaGVhZGVyVGl0bGUgPSAnJztcbiAgICAgICAgaWYgKChjb2x1bW5EZWYuaGVhZGVyS2V5IHx8IGNvbHVtbkRlZi5uYW1lS2V5KSAmJiB0aGlzLl9ncmlkT3B0aW9ucy5lbmFibGVUcmFuc2xhdGUgJiYgdGhpcy50cmFuc2xhdGUgJiYgdGhpcy50cmFuc2xhdGUuY3VycmVudExhbmcgJiYgdGhpcy50cmFuc2xhdGUuaW5zdGFudCkge1xuICAgICAgICAgIGhlYWRlclRpdGxlID0gdGhpcy50cmFuc2xhdGUuaW5zdGFudCgoY29sdW1uRGVmLmhlYWRlcktleSB8fCBjb2x1bW5EZWYubmFtZUtleSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGhlYWRlclRpdGxlID0gY29sdW1uRGVmLm5hbWUgfHwgdGl0bGVDYXNlKGNvbHVtbkRlZi5maWVsZCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc2tpcHBlZEZpZWxkID0gY29sdW1uRGVmLmV4Y2x1ZGVGcm9tRXhwb3J0IHx8IGZhbHNlO1xuXG4gICAgICAgIC8vIGlmIGNvbHVtbiB3aWR0aCBpcyAwLCB0aGVuIHdlIGNvbnNpZGVyIHRoYXQgZmllbGQgYXMgYSBoaWRkZW4gZmllbGQgYW5kIHNob3VsZCBub3QgYmUgcGFydCBvZiB0aGUgZXhwb3J0XG4gICAgICAgIGlmICgoY29sdW1uRGVmLndpZHRoID09PSB1bmRlZmluZWQgfHwgY29sdW1uRGVmLndpZHRoID4gMCkgJiYgIXNraXBwZWRGaWVsZCkge1xuICAgICAgICAgIGNvbHVtbkhlYWRlcnMucHVzaCh7XG4gICAgICAgICAgICBrZXk6IGNvbHVtbkRlZi5maWVsZCB8fCBjb2x1bW5EZWYuaWQsXG4gICAgICAgICAgICB0aXRsZTogaGVhZGVyVGl0bGVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNvbHVtbkhlYWRlcnM7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBkYXRhIG9mIGEgcmVndWxhciByb3cgKGEgcm93IHdpdGhvdXQgZ3JvdXBpbmcpXG4gICAqIEBwYXJhbSByb3dcbiAgICogQHBhcmFtIGl0ZW1PYmpcbiAgICovXG4gIHByaXZhdGUgcmVhZFJlZ3VsYXJSb3dEYXRhKGNvbHVtbnM6IENvbHVtbltdLCByb3c6IG51bWJlciwgaXRlbU9iajogYW55KSB7XG4gICAgbGV0IGlkeCA9IDA7XG4gICAgY29uc3Qgcm93T3V0cHV0U3RyaW5ncyA9IFtdO1xuICAgIGNvbnN0IGV4cG9ydFF1b3RlV3JhcHBlciA9IHRoaXMuX2V4cG9ydFF1b3RlV3JhcHBlcjtcblxuICAgIGZvciAobGV0IGNvbCA9IDAsIGxuID0gY29sdW1ucy5sZW5ndGg7IGNvbCA8IGxuOyBjb2wrKykge1xuICAgICAgY29uc3QgY29sdW1uRGVmID0gY29sdW1uc1tjb2xdO1xuXG4gICAgICAvLyBza2lwIGV4Y2x1ZGVkIGNvbHVtblxuICAgICAgaWYgKGNvbHVtbkRlZi5leGNsdWRlRnJvbUV4cG9ydCkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgLy8gaWYgd2UgYXJlIGdyb3VwaW5nIGFuZCBhcmUgb24gMXN0IGNvbHVtbiBpbmRleCwgd2UgbmVlZCB0byBza2lwIHRoaXMgY29sdW1uIHNpbmNlIGl0IHdpbGwgYmUgdXNlZCBsYXRlciBieSB0aGUgZ3JvdXBpbmcgdGV4dDo6IEdyb3VwIGJ5IFtjb2x1bW5YXVxuICAgICAgaWYgKHRoaXMuX2hhc0dyb3VwZWRJdGVtcyAmJiBpZHggPT09IDApIHtcbiAgICAgICAgY29uc3QgZW1wdHlWYWx1ZSA9IHRoaXMuX2ZpbGVGb3JtYXQgPT09IEZpbGVUeXBlLmNzdiA/IGBcIlwiYCA6ICcnO1xuICAgICAgICByb3dPdXRwdXRTdHJpbmdzLnB1c2goZW1wdHlWYWx1ZSk7XG4gICAgICB9XG5cbiAgICAgIC8vIGdldCB0aGUgb3V0cHV0IGJ5IGFuYWx5emluZyBpZiB3ZSdsbCBwdWxsIHRoZSB2YWx1ZSBmcm9tIHRoZSBjZWxsIG9yIGZyb20gYSBmb3JtYXR0ZXJcbiAgICAgIGxldCBpdGVtRGF0YSA9IGV4cG9ydFdpdGhGb3JtYXR0ZXJXaGVuRGVmaW5lZChyb3csIGNvbCwgaXRlbU9iaiwgY29sdW1uRGVmLCB0aGlzLl9ncmlkLCB0aGlzLl9leHBvcnRPcHRpb25zKTtcblxuICAgICAgLy8gZG9lcyB0aGUgdXNlciB3YW50IHRvIHNhbml0aXplIHRoZSBvdXRwdXQgZGF0YSAocmVtb3ZlIEhUTUwgdGFncyk/XG4gICAgICBpZiAoY29sdW1uRGVmLnNhbml0aXplRGF0YUV4cG9ydCB8fCB0aGlzLl9leHBvcnRPcHRpb25zLnNhbml0aXplRGF0YUV4cG9ydCkge1xuICAgICAgICBpdGVtRGF0YSA9IHNhbml0aXplSHRtbFRvVGV4dChpdGVtRGF0YSk7XG4gICAgICB9XG5cbiAgICAgIC8vIHdoZW4gQ1NWIHdlIGFsc28gbmVlZCB0byBlc2NhcGUgZG91YmxlIHF1b3RlcyB0d2ljZSwgc28gXCIgYmVjb21lcyBcIlwiXG4gICAgICBpZiAodGhpcy5fZmlsZUZvcm1hdCA9PT0gRmlsZVR5cGUuY3N2ICYmIGl0ZW1EYXRhKSB7XG4gICAgICAgIGl0ZW1EYXRhID0gaXRlbURhdGEudG9TdHJpbmcoKS5yZXBsYWNlKC9cIi9naSwgYFwiXCJgKTtcbiAgICAgIH1cblxuICAgICAgLy8gZG8gd2UgaGF2ZSBhIHdyYXBwZXIgdG8ga2VlcCBhcyBhIHN0cmluZz8gaW4gY2VydGFpbiBjYXNlcyBsaWtlIFwiMUUwNlwiLCB3ZSBkb24ndCB3YW50IGV4Y2VsIHRvIHRyYW5zZm9ybSBpdCBpbnRvIGV4cG9uZW50aWFsICgxLjBFMDYpXG4gICAgICAvLyB0byBjYW5jZWwgdGhhdCBlZmZlY3Qgd2UgY2FuIGhhZCA9IGluIGZyb250LCBleDogPVwiMUUwNlwiXG4gICAgICBjb25zdCBrZWVwQXNTdHJpbmdXcmFwcGVyID0gKGNvbHVtbkRlZiAmJiBjb2x1bW5EZWYuZXhwb3J0Q3N2Rm9yY2VUb0tlZXBBc1N0cmluZykgPyAnPScgOiAnJztcblxuICAgICAgcm93T3V0cHV0U3RyaW5ncy5wdXNoKGtlZXBBc1N0cmluZ1dyYXBwZXIgKyBleHBvcnRRdW90ZVdyYXBwZXIgKyBpdGVtRGF0YSArIGV4cG9ydFF1b3RlV3JhcHBlcik7XG4gICAgICBpZHgrKztcbiAgICB9XG5cbiAgICByZXR1cm4gcm93T3V0cHV0U3RyaW5ncy5qb2luKHRoaXMuX2RlbGltaXRlcik7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBncm91cGVkIHRpdGxlKHMpIGFuZCBpdHMgZ3JvdXAgdGl0bGUgZm9ybWF0dGVyLCBmb3IgZXhhbXBsZSBpZiB3ZSBncm91cGVkIGJ5IHNhbGVzUmVwLCB0aGUgcmV0dXJuZWQgcmVzdWx0IHdvdWxkIGJlOjogJ1NhbGVzIFJlcDogSm9obiBEb3cgKDIgaXRlbXMpJ1xuICAgKiBAcGFyYW0gaXRlbU9ialxuICAgKi9cbiAgcHJpdmF0ZSByZWFkR3JvdXBlZFRpdGxlUm93KGl0ZW1PYmo6IGFueSkge1xuICAgIGxldCBncm91cE5hbWUgPSBzYW5pdGl6ZUh0bWxUb1RleHQoaXRlbU9iai50aXRsZSk7XG4gICAgY29uc3QgZXhwb3J0UXVvdGVXcmFwcGVyID0gdGhpcy5fZXhwb3J0UXVvdGVXcmFwcGVyO1xuXG4gICAgZ3JvdXBOYW1lID0gYWRkV2hpdGVTcGFjZXMoNSAqIGl0ZW1PYmoubGV2ZWwpICsgZ3JvdXBOYW1lO1xuXG4gICAgaWYgKHRoaXMuX2ZpbGVGb3JtYXQgPT09IEZpbGVUeXBlLmNzdikge1xuICAgICAgLy8gd2hlbiBDU1Ygd2UgYWxzbyBuZWVkIHRvIGVzY2FwZSBkb3VibGUgcXVvdGVzIHR3aWNlLCBzbyBcIiBiZWNvbWVzIFwiXCJcbiAgICAgIGdyb3VwTmFtZSA9IGdyb3VwTmFtZS50b1N0cmluZygpLnJlcGxhY2UoL1wiL2dpLCBgXCJcImApO1xuICAgIH1cbiAgICByZXR1cm4gZXhwb3J0UXVvdGVXcmFwcGVyICsgZ3JvdXBOYW1lICsgZXhwb3J0UXVvdGVXcmFwcGVyO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgZ3JvdXBlZCB0b3RhbHMgKGJlbG93IHRoZSByZWd1bGFyIHJvd3MpLCB0aGVzZSBhcmUgc2V0IGJ5IFNsaWNrIEFnZ3JlZ2F0b3JzLlxuICAgKiBGb3IgZXhhbXBsZSBpZiB3ZSBncm91cGVkIGJ5IFwic2FsZXNSZXBcIiBhbmQgd2UgaGF2ZSBhIFN1bSBBZ2dyZWdhdG9yIG9uIFwic2FsZXNcIiwgdGhlbiB0aGUgcmV0dXJuZWQgb3V0cHV0IHdvdWxkIGJlOjogW1wiU3VtIDEyMyRcIl1cbiAgICogQHBhcmFtIGl0ZW1PYmpcbiAgICovXG4gIHByaXZhdGUgcmVhZEdyb3VwZWRUb3RhbFJvdyhjb2x1bW5zOiBDb2x1bW5bXSwgaXRlbU9iajogYW55KSB7XG4gICAgY29uc3QgZGVsaW1pdGVyID0gdGhpcy5fZXhwb3J0T3B0aW9ucy5kZWxpbWl0ZXI7XG4gICAgY29uc3QgZm9ybWF0ID0gdGhpcy5fZXhwb3J0T3B0aW9ucy5mb3JtYXQ7XG4gICAgY29uc3QgZ3JvdXBpbmdBZ2dyZWdhdG9yUm93VGV4dCA9IHRoaXMuX2V4cG9ydE9wdGlvbnMuZ3JvdXBpbmdBZ2dyZWdhdG9yUm93VGV4dCB8fCAnJztcbiAgICBjb25zdCBleHBvcnRRdW90ZVdyYXBwZXIgPSB0aGlzLl9leHBvcnRRdW90ZVdyYXBwZXI7XG4gICAgY29uc3Qgb3V0cHV0U3RyaW5ncyA9IFtgJHtleHBvcnRRdW90ZVdyYXBwZXJ9JHtncm91cGluZ0FnZ3JlZ2F0b3JSb3dUZXh0fSR7ZXhwb3J0UXVvdGVXcmFwcGVyfWBdO1xuXG4gICAgY29sdW1ucy5mb3JFYWNoKChjb2x1bW5EZWYpID0+IHtcbiAgICAgIGxldCBpdGVtRGF0YSA9ICcnO1xuXG4gICAgICBjb25zdCBza2lwcGVkRmllbGQgPSBjb2x1bW5EZWYuZXhjbHVkZUZyb21FeHBvcnQgfHwgZmFsc2U7XG5cbiAgICAgIC8vIGlmIHRoZXJlJ3MgYSBncm91cFRvdGFsc0Zvcm1hdHRlciwgd2Ugd2lsbCByZS1ydW4gaXQgdG8gZ2V0IHRoZSBleGFjdCBzYW1lIG91dHB1dCBhcyB3aGF0IGlzIHNob3duIGluIFVJXG4gICAgICBpZiAoY29sdW1uRGVmLmdyb3VwVG90YWxzRm9ybWF0dGVyKSB7XG4gICAgICAgIGl0ZW1EYXRhID0gY29sdW1uRGVmLmdyb3VwVG90YWxzRm9ybWF0dGVyKGl0ZW1PYmosIGNvbHVtbkRlZik7XG4gICAgICB9XG5cbiAgICAgIC8vIGRvZXMgdGhlIHVzZXIgd2FudCB0byBzYW5pdGl6ZSB0aGUgb3V0cHV0IGRhdGEgKHJlbW92ZSBIVE1MIHRhZ3MpP1xuICAgICAgaWYgKGNvbHVtbkRlZi5zYW5pdGl6ZURhdGFFeHBvcnQgfHwgdGhpcy5fZXhwb3J0T3B0aW9ucy5zYW5pdGl6ZURhdGFFeHBvcnQpIHtcbiAgICAgICAgaXRlbURhdGEgPSBzYW5pdGl6ZUh0bWxUb1RleHQoaXRlbURhdGEpO1xuICAgICAgfVxuXG4gICAgICBpZiAoZm9ybWF0ID09PSBGaWxlVHlwZS5jc3YpIHtcbiAgICAgICAgLy8gd2hlbiBDU1Ygd2UgYWxzbyBuZWVkIHRvIGVzY2FwZSBkb3VibGUgcXVvdGVzIHR3aWNlLCBzbyBhIGRvdWJsZSBxdW90ZSBcIiBiZWNvbWVzIDJ4IGRvdWJsZSBxdW90ZXMgXCJcIlxuICAgICAgICBpdGVtRGF0YSA9IGl0ZW1EYXRhLnRvU3RyaW5nKCkucmVwbGFjZSgvXCIvZ2ksIGBcIlwiYCk7XG4gICAgICB9XG5cbiAgICAgIC8vIGFkZCB0aGUgY29sdW1uICh1bmxlc3MgdXNlciB3YW50cyB0byBza2lwIGl0KVxuICAgICAgaWYgKChjb2x1bW5EZWYud2lkdGggPT09IHVuZGVmaW5lZCB8fCBjb2x1bW5EZWYud2lkdGggPiAwKSAmJiAhc2tpcHBlZEZpZWxkKSB7XG4gICAgICAgIG91dHB1dFN0cmluZ3MucHVzaChleHBvcnRRdW90ZVdyYXBwZXIgKyBpdGVtRGF0YSArIGV4cG9ydFF1b3RlV3JhcHBlcik7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gb3V0cHV0U3RyaW5ncy5qb2luKGRlbGltaXRlcik7XG4gIH1cbn1cbiJdfQ==