import * as ɵngcc0 from '@angular/core';
export class GridEventService {
    get eventHandler() {
        return this._eventHandler;
    }
    constructor() {
        this._eventHandler = new Slick.EventHandler();
    }
    dispose() {
        this._eventHandler.unsubscribeAll();
        this.handleOnCellChange = null;
        this.handleOnCellClick = null;
    }
    /* OnCellChange Event */
    bindOnCellChange(grid, dataView) {
        // subscribe to this Slickgrid event of onCellChange
        this._eventHandler.subscribe(grid.onCellChange, (e, args) => {
            this.handleOnCellChange.call(this, grid, dataView, e, args);
        });
    }
    /* OnClick Event */
    bindOnClick(grid, dataView) {
        this._eventHandler.subscribe(grid.onClick, (e, args) => {
            this.handleOnCellClick.call(this, grid, dataView, e, args);
        });
    }
    //
    // private functions
    // ------------------
    /* OnCellChange Event Handler */
    handleOnCellChange(grid, dataView, e, args) {
        if (!e || !args || !grid || args.cell === undefined || !grid.getColumns || !grid.getDataItem) {
            return;
        }
        const column = grid.getColumns()[args.cell];
        // if the column definition has a onCellChange property (a callback function), then run it
        if (typeof column.onCellChange === 'function') {
            // add to the output gridOptions & dataView since we'll need them inside the AJAX column.onCellChange
            const returnedArgs = {
                row: args.row,
                cell: args.cell,
                dataView,
                grid,
                columnDef: column,
                dataContext: grid.getDataItem(args.row)
            };
            // finally call up the Slick.column.onCellChanges.... function
            column.onCellChange(e, returnedArgs);
        }
    }
    /* OnCellClick Event Handler */
    handleOnCellClick(grid, dataView, e, args) {
        if (!e || !args || !grid || args.cell === undefined || !grid.getColumns || !grid.getDataItem) {
            return;
        }
        const column = grid && grid.getColumns && grid.getColumns()[args.cell];
        const gridOptions = grid && grid.getOptions && grid.getOptions() || {};
        // only when using autoCommitEdit, we will make the cell active (in focus) when clicked
        // setting the cell as active as a side effect and if autoCommitEdit is set to false then the Editors won't save correctly
        if (gridOptions.enableCellNavigation && (!gridOptions.editable || (gridOptions.editable && gridOptions.autoCommitEdit))) {
            grid.setActiveCell(args.row, args.cell);
        }
        // if the column definition has a onCellClick property (a callback function), then run it
        if (typeof column.onCellClick === 'function') {
            // add to the output gridOptions & dataView since we'll need them inside the AJAX column.onClick
            const returnedArgs = {
                row: args.row,
                cell: args.cell,
                dataView,
                grid,
                columnDef: column,
                dataContext: grid.getDataItem(args.row)
            };
            // finally call up the Slick.column.onCellClick.... function
            column.onCellClick(e, returnedArgs);
        }
    }
}
GridEventService.ɵfac = function GridEventService_Factory(t) { return new (t || GridEventService)(); };
GridEventService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: GridEventService, factory: GridEventService.ɵfac });

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3JpZEV2ZW50LnNlcnZpY2UuanMiLCJzb3VyY2VzIjpbIm5nOi9hbmd1bGFyLXNsaWNrZ3JpZC9hcHAvbW9kdWxlcy9hbmd1bGFyLXNsaWNrZ3JpZC9zZXJ2aWNlcy9ncmlkRXZlbnQuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBS0EsTUFBTSxPQUFPLGdCQUFnQjtBQUM3QixJQUVFLElBQUksWUFBWTtBQUFLLFFBQ25CLE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQztBQUM5QixJQUFFLENBQUM7QUFDSCxJQUNFO0FBQ0YsUUFBSSxJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksS0FBSyxDQUFDLFlBQVksRUFBRSxDQUFDO0FBQ2xELElBQUUsQ0FBQztBQUNILElBQ0UsT0FBTztBQUNULFFBQUksSUFBSSxDQUFDLGFBQWEsQ0FBQyxjQUFjLEVBQUUsQ0FBQztBQUN4QyxRQUFJLElBQUksQ0FBQyxrQkFBa0IsR0FBRyxJQUFJLENBQUM7QUFDbkMsUUFBSSxJQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxDQUFDO0FBQ2xDLElBQUUsQ0FBQztBQUNILElBQ0Usd0JBQXdCO0FBQzFCLElBQUUsZ0JBQWdCLENBQUMsSUFBUyxFQUFFLFFBQWE7QUFDM0MsUUFBSSxvREFBb0Q7QUFDeEQsUUFBSSxJQUFJLENBQUMsYUFBYSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFFLENBQUMsQ0FBNkIsRUFBRSxJQUFjLEVBQUUsRUFBRTtBQUN0RyxZQUFNLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQ2xFLFFBQUksQ0FBQyxDQUFDLENBQUM7QUFDUCxJQUFFLENBQUM7QUFDSCxJQUNFLG1CQUFtQjtBQUNyQixJQUFFLFdBQVcsQ0FBQyxJQUFTLEVBQUUsUUFBYTtBQUN0QyxRQUFJLElBQUksQ0FBQyxhQUFhLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUE2QixFQUFFLElBQWMsRUFBRSxFQUFFO0FBQ2pHLFlBQU0sSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDakUsUUFBSSxDQUFDLENBQUMsQ0FBQztBQUNQLElBQUUsQ0FBQztBQUNILElBQ0UsRUFBRTtBQUNKLElBQUUsb0JBQW9CO0FBQ3RCLElBQUUscUJBQXFCO0FBQ3ZCLElBQ0UsZ0NBQWdDO0FBQ2xDLElBQUUsa0JBQWtCLENBQUMsSUFBUyxFQUFFLFFBQWEsRUFBRSxDQUE2QixFQUFFLElBQWM7QUFDNUYsUUFBSSxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxJQUFJLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxJQUFJLEtBQUssU0FBUyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUU7QUFDbEcsWUFBTSxPQUFPO0FBQ2IsU0FBSztBQUNMLFFBQUksTUFBTSxNQUFNLEdBQVcsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUN4RCxRQUNJLDBGQUEwRjtBQUM5RixRQUFJLElBQUksT0FBTyxNQUFNLENBQUMsWUFBWSxLQUFLLFVBQVUsRUFBRTtBQUNuRCxZQUFNLHFHQUFxRztBQUMzRyxZQUFNLE1BQU0sWUFBWSxHQUFnQjtBQUN4QyxnQkFBUSxHQUFHLEVBQUUsSUFBSSxDQUFDLEdBQUc7QUFDckIsZ0JBQVEsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJO0FBQ3ZCLGdCQUFRLFFBQVE7QUFDaEIsZ0JBQVEsSUFBSTtBQUNaLGdCQUFRLFNBQVMsRUFBRSxNQUFNO0FBQ3pCLGdCQUFRLFdBQVcsRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUM7QUFDL0MsYUFBTyxDQUFDO0FBQ1IsWUFDTSw4REFBOEQ7QUFDcEUsWUFBTSxNQUFNLENBQUMsWUFBWSxDQUFDLENBQUMsRUFBRSxZQUFZLENBQUMsQ0FBQztBQUMzQyxTQUFLO0FBQ0wsSUFBRSxDQUFDO0FBQ0gsSUFDRSwrQkFBK0I7QUFDakMsSUFBVSxpQkFBaUIsQ0FBQyxJQUFTLEVBQUUsUUFBYSxFQUFFLENBQTZCLEVBQUUsSUFBYztBQUNuRyxRQUFJLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksQ0FBQyxJQUFJLElBQUksSUFBSSxDQUFDLElBQUksS0FBSyxTQUFTLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRTtBQUNsRyxZQUFNLE9BQU87QUFDYixTQUFLO0FBQ0wsUUFBSSxNQUFNLE1BQU0sR0FBVyxJQUFJLElBQUksSUFBSSxDQUFDLFVBQVUsSUFBSSxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ25GLFFBQUksTUFBTSxXQUFXLEdBQWUsSUFBSSxJQUFJLElBQUksQ0FBQyxVQUFVLElBQUksSUFBSSxDQUFDLFVBQVUsRUFBRSxJQUFJLEVBQUUsQ0FBQztBQUN2RixRQUNJLHVGQUF1RjtBQUMzRixRQUFJLDBIQUEwSDtBQUM5SCxRQUFJLElBQUksV0FBVyxDQUFDLG9CQUFvQixJQUFJLENBQUMsQ0FBQyxXQUFXLENBQUMsUUFBUSxJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsSUFBSSxXQUFXLENBQUMsY0FBYyxDQUFDLENBQUMsRUFBRTtBQUM3SCxZQUFNLElBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDOUMsU0FBSztBQUNMLFFBQ0kseUZBQXlGO0FBQzdGLFFBQUksSUFBSSxPQUFPLE1BQU0sQ0FBQyxXQUFXLEtBQUssVUFBVSxFQUFFO0FBQ2xELFlBQU0sZ0dBQWdHO0FBQ3RHLFlBQU0sTUFBTSxZQUFZLEdBQWdCO0FBQ3hDLGdCQUFRLEdBQUcsRUFBRSxJQUFJLENBQUMsR0FBRztBQUNyQixnQkFBUSxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUk7QUFDdkIsZ0JBQVEsUUFBUTtBQUNoQixnQkFBUSxJQUFJO0FBQ1osZ0JBQVEsU0FBUyxFQUFFLE1BQU07QUFDekIsZ0JBQVEsV0FBVyxFQUFFLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQztBQUMvQyxhQUFPLENBQUM7QUFDUixZQUNNLDREQUE0RDtBQUNsRSxZQUFNLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxFQUFFLFlBQVksQ0FBQyxDQUFDO0FBQzFDLFNBQUs7QUFDTCxJQUFFLENBQUM7QUFDSDs7OztBQTFGQSxBQUFBLEFBQUEsQUFBQSxBQUdBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUVBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFDQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENlbGxBcmdzLCBDb2x1bW4sIEdyaWRPcHRpb24sIE9uRXZlbnRBcmdzLCBTbGlja0V2ZW50SGFuZGxlciB9IGZyb20gJy4vLi4vbW9kZWxzL2luZGV4JztcclxuXHJcbi8vIHVzaW5nIGV4dGVybmFsIG5vbi10eXBlZCBqcyBsaWJyYXJpZXNcclxuZGVjbGFyZSBjb25zdCBTbGljazogYW55O1xyXG5cclxuZXhwb3J0IGNsYXNzIEdyaWRFdmVudFNlcnZpY2Uge1xyXG4gIHByaXZhdGUgX2V2ZW50SGFuZGxlcjogU2xpY2tFdmVudEhhbmRsZXI7XHJcblxyXG4gIGdldCBldmVudEhhbmRsZXIoKTogU2xpY2tFdmVudEhhbmRsZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuX2V2ZW50SGFuZGxlcjtcclxuICB9XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgdGhpcy5fZXZlbnRIYW5kbGVyID0gbmV3IFNsaWNrLkV2ZW50SGFuZGxlcigpO1xyXG4gIH1cclxuXHJcbiAgZGlzcG9zZSgpIHtcclxuICAgIHRoaXMuX2V2ZW50SGFuZGxlci51bnN1YnNjcmliZUFsbCgpO1xyXG4gICAgdGhpcy5oYW5kbGVPbkNlbGxDaGFuZ2UgPSBudWxsO1xyXG4gICAgdGhpcy5oYW5kbGVPbkNlbGxDbGljayA9IG51bGw7XHJcbiAgfVxyXG5cclxuICAvKiBPbkNlbGxDaGFuZ2UgRXZlbnQgKi9cclxuICBiaW5kT25DZWxsQ2hhbmdlKGdyaWQ6IGFueSwgZGF0YVZpZXc6IGFueSkge1xyXG4gICAgLy8gc3Vic2NyaWJlIHRvIHRoaXMgU2xpY2tncmlkIGV2ZW50IG9mIG9uQ2VsbENoYW5nZVxyXG4gICAgdGhpcy5fZXZlbnRIYW5kbGVyLnN1YnNjcmliZShncmlkLm9uQ2VsbENoYW5nZSwgKGU6IEtleWJvYXJkRXZlbnQgfCBNb3VzZUV2ZW50LCBhcmdzOiBDZWxsQXJncykgPT4ge1xyXG4gICAgICB0aGlzLmhhbmRsZU9uQ2VsbENoYW5nZS5jYWxsKHRoaXMsIGdyaWQsIGRhdGFWaWV3LCBlLCBhcmdzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyogT25DbGljayBFdmVudCAqL1xyXG4gIGJpbmRPbkNsaWNrKGdyaWQ6IGFueSwgZGF0YVZpZXc6IGFueSkge1xyXG4gICAgdGhpcy5fZXZlbnRIYW5kbGVyLnN1YnNjcmliZShncmlkLm9uQ2xpY2ssIChlOiBLZXlib2FyZEV2ZW50IHwgTW91c2VFdmVudCwgYXJnczogQ2VsbEFyZ3MpID0+IHtcclxuICAgICAgdGhpcy5oYW5kbGVPbkNlbGxDbGljay5jYWxsKHRoaXMsIGdyaWQsIGRhdGFWaWV3LCBlLCBhcmdzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy9cclxuICAvLyBwcml2YXRlIGZ1bmN0aW9uc1xyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAvKiBPbkNlbGxDaGFuZ2UgRXZlbnQgSGFuZGxlciAqL1xyXG4gIGhhbmRsZU9uQ2VsbENoYW5nZShncmlkOiBhbnksIGRhdGFWaWV3OiBhbnksIGU6IEtleWJvYXJkRXZlbnQgfCBNb3VzZUV2ZW50LCBhcmdzOiBDZWxsQXJncykge1xyXG4gICAgaWYgKCFlIHx8ICFhcmdzIHx8ICFncmlkIHx8IGFyZ3MuY2VsbCA9PT0gdW5kZWZpbmVkIHx8ICFncmlkLmdldENvbHVtbnMgfHwgIWdyaWQuZ2V0RGF0YUl0ZW0pIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgY29sdW1uOiBDb2x1bW4gPSBncmlkLmdldENvbHVtbnMoKVthcmdzLmNlbGxdO1xyXG5cclxuICAgIC8vIGlmIHRoZSBjb2x1bW4gZGVmaW5pdGlvbiBoYXMgYSBvbkNlbGxDaGFuZ2UgcHJvcGVydHkgKGEgY2FsbGJhY2sgZnVuY3Rpb24pLCB0aGVuIHJ1biBpdFxyXG4gICAgaWYgKHR5cGVvZiBjb2x1bW4ub25DZWxsQ2hhbmdlID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgIC8vIGFkZCB0byB0aGUgb3V0cHV0IGdyaWRPcHRpb25zICYgZGF0YVZpZXcgc2luY2Ugd2UnbGwgbmVlZCB0aGVtIGluc2lkZSB0aGUgQUpBWCBjb2x1bW4ub25DZWxsQ2hhbmdlXHJcbiAgICAgIGNvbnN0IHJldHVybmVkQXJnczogT25FdmVudEFyZ3MgPSB7XHJcbiAgICAgICAgcm93OiBhcmdzLnJvdyxcclxuICAgICAgICBjZWxsOiBhcmdzLmNlbGwsXHJcbiAgICAgICAgZGF0YVZpZXcsXHJcbiAgICAgICAgZ3JpZCxcclxuICAgICAgICBjb2x1bW5EZWY6IGNvbHVtbixcclxuICAgICAgICBkYXRhQ29udGV4dDogZ3JpZC5nZXREYXRhSXRlbShhcmdzLnJvdylcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIGZpbmFsbHkgY2FsbCB1cCB0aGUgU2xpY2suY29sdW1uLm9uQ2VsbENoYW5nZXMuLi4uIGZ1bmN0aW9uXHJcbiAgICAgIGNvbHVtbi5vbkNlbGxDaGFuZ2UoZSwgcmV0dXJuZWRBcmdzKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qIE9uQ2VsbENsaWNrIEV2ZW50IEhhbmRsZXIgKi9cclxuICBwcml2YXRlIGhhbmRsZU9uQ2VsbENsaWNrKGdyaWQ6IGFueSwgZGF0YVZpZXc6IGFueSwgZTogS2V5Ym9hcmRFdmVudCB8IE1vdXNlRXZlbnQsIGFyZ3M6IENlbGxBcmdzKSB7XHJcbiAgICBpZiAoIWUgfHwgIWFyZ3MgfHwgIWdyaWQgfHwgYXJncy5jZWxsID09PSB1bmRlZmluZWQgfHwgIWdyaWQuZ2V0Q29sdW1ucyB8fCAhZ3JpZC5nZXREYXRhSXRlbSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBjb2x1bW46IENvbHVtbiA9IGdyaWQgJiYgZ3JpZC5nZXRDb2x1bW5zICYmIGdyaWQuZ2V0Q29sdW1ucygpW2FyZ3MuY2VsbF07XHJcbiAgICBjb25zdCBncmlkT3B0aW9uczogR3JpZE9wdGlvbiA9IGdyaWQgJiYgZ3JpZC5nZXRPcHRpb25zICYmIGdyaWQuZ2V0T3B0aW9ucygpIHx8IHt9O1xyXG5cclxuICAgIC8vIG9ubHkgd2hlbiB1c2luZyBhdXRvQ29tbWl0RWRpdCwgd2Ugd2lsbCBtYWtlIHRoZSBjZWxsIGFjdGl2ZSAoaW4gZm9jdXMpIHdoZW4gY2xpY2tlZFxyXG4gICAgLy8gc2V0dGluZyB0aGUgY2VsbCBhcyBhY3RpdmUgYXMgYSBzaWRlIGVmZmVjdCBhbmQgaWYgYXV0b0NvbW1pdEVkaXQgaXMgc2V0IHRvIGZhbHNlIHRoZW4gdGhlIEVkaXRvcnMgd29uJ3Qgc2F2ZSBjb3JyZWN0bHlcclxuICAgIGlmIChncmlkT3B0aW9ucy5lbmFibGVDZWxsTmF2aWdhdGlvbiAmJiAoIWdyaWRPcHRpb25zLmVkaXRhYmxlIHx8IChncmlkT3B0aW9ucy5lZGl0YWJsZSAmJiBncmlkT3B0aW9ucy5hdXRvQ29tbWl0RWRpdCkpKSB7XHJcbiAgICAgIGdyaWQuc2V0QWN0aXZlQ2VsbChhcmdzLnJvdywgYXJncy5jZWxsKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBpZiB0aGUgY29sdW1uIGRlZmluaXRpb24gaGFzIGEgb25DZWxsQ2xpY2sgcHJvcGVydHkgKGEgY2FsbGJhY2sgZnVuY3Rpb24pLCB0aGVuIHJ1biBpdFxyXG4gICAgaWYgKHR5cGVvZiBjb2x1bW4ub25DZWxsQ2xpY2sgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgLy8gYWRkIHRvIHRoZSBvdXRwdXQgZ3JpZE9wdGlvbnMgJiBkYXRhVmlldyBzaW5jZSB3ZSdsbCBuZWVkIHRoZW0gaW5zaWRlIHRoZSBBSkFYIGNvbHVtbi5vbkNsaWNrXHJcbiAgICAgIGNvbnN0IHJldHVybmVkQXJnczogT25FdmVudEFyZ3MgPSB7XHJcbiAgICAgICAgcm93OiBhcmdzLnJvdyxcclxuICAgICAgICBjZWxsOiBhcmdzLmNlbGwsXHJcbiAgICAgICAgZGF0YVZpZXcsXHJcbiAgICAgICAgZ3JpZCxcclxuICAgICAgICBjb2x1bW5EZWY6IGNvbHVtbixcclxuICAgICAgICBkYXRhQ29udGV4dDogZ3JpZC5nZXREYXRhSXRlbShhcmdzLnJvdylcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIGZpbmFsbHkgY2FsbCB1cCB0aGUgU2xpY2suY29sdW1uLm9uQ2VsbENsaWNrLi4uLiBmdW5jdGlvblxyXG4gICAgICBjb2x1bW4ub25DZWxsQ2xpY2soZSwgcmV0dXJuZWRBcmdzKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIl19