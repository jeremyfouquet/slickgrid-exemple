{"version":3,"file":"ngx-order-pipe.umd.js","sources":["../../src/app/order-pipe/ngx-order.pipe.ts","../../src/app/order-pipe/ngx-order.module.ts","../../ngx-order-pipe.ts"],"names":["Pipe","NgModule"],"mappings":";;;;;;;QAMA;AAAuB;AAAU;AAAY;AAEhB;AAE5B;AAEA;AAAY,QAAJ,kBAAQ,GAAf,UAAgB,KAAU;AAC5B,YAAI,OAAO,OAAO,KAAK,KAAK,QAAQ,IAAI,KAAK,YAAY,MAAM,CAAC;AAChE,SAAG;AAEH;AACM;AAEC;AACH;AAEA;AAAoB;AAAY,QAA3B,6BAAmB,GAA1B,UAA2B,CAAM,EAAE,CAAM;AAC3C,YAAI,IAAI,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE;AACxD,gBAAM,OAAO,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;AAChC,aAAK;AACL,YAAI,OAAO,SAAS,CAAC,cAAc,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAC1C,SAAG;AAEH;AACM;AAEC;AACH;AAEA;AAAoB;AAAY,QAA3B,wBAAc,GAArB,UAAsB,CAAM,EAAE,CAAM;AACtC,YAAI,IAAI,CAAC,IAAI,CAAC,YAAY,IAAI,EAAE;AAChC,gBAAM,CAAC,GAAG,CAAC,CAAC,OAAO,EAAE,CAAC;AACtB,aAAK;AACL,YAAI,IAAI,CAAC,IAAI,CAAC,YAAY,IAAI,EAAE;AAChC,gBAAM,CAAC,GAAG,CAAC,CAAC,OAAO,EAAE,CAAC;AACtB,aAAK;AACL,YACI,IAAI,CAAC,KAAK,CAAC,EAAE;AACjB,gBAAM,OAAO,CAAC,CAAC;AACf,aAAK;AACL,YAAI,IAAI,CAAC,IAAI,IAAI,EAAE;AACnB,gBAAM,OAAO,CAAC,CAAC;AACf,aAAK;AACL,YAAI,IAAI,CAAC,IAAI,IAAI,EAAE;AACnB,gBAAM,OAAO,CAAC,CAAC,CAAC;AAChB,aAAK;AACL,YAAI,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;AAC1B,SAAG;AAEH;AACM;AACM;AACM;AAEA;AAAY,QAArB,yBAAe,GAAtB,UAAuB,UAAkB;AAAI,YAC3C,UAAU,GAAG,UAAU,CAAC,OAAO,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;AACzD,YAAI,UAAU,GAAG,UAAU,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;AAC/C,YAAI,OAAO,UAAU,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;AACjC,SAAG;AAEH;AACM;AAEC;AAAW;AAEjB;AAEG;AAA0B;AAAY,QAAjC,kBAAQ,GAAf,UAAgB,MAAW,EAAE,UAAoB;AACnD,YAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;AACvD,gBAAM,IAAI,CAAC,MAAM,EAAE;AACnB,oBAAQ,OAAO;AACf,iBAAO;AACP,gBAAM,IAAM,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC;AAC9B,gBAAM,IAAI,EAAE,CAAC,IAAI,MAAM,CAAC,EAAE;AAC1B,oBAAQ,OAAO;AACf,iBAAO;AACP,gBAAM,IAAI,OAAO,MAAM,CAAC,CAAC,CAAC,KAAK,UAAU,EAAE;AAC3C,oBAAQ,MAAM,GAAG,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC;AAC7B,iBAAO;AAAC,qBAAK;AACb,oBAAQ,MAAM,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;AAC3B,iBAAO;AACP,aAAK;AACL,YACI,OAAO,MAAM,CAAC;AAClB,SAAG;AAEH;AACM;AAEC;AAAW;AAEZ;AAEL;AAA6B;AAAY,QAAjC,kBAAQ,GAAf,UAAgB,MAAW,EAAE,KAAU,EAAE,UAAoB;AAC/D,YAAI,IAAI,CAAC,CAAC;AACV,YAAI,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;AAChD,gBAAM,MAAM,GAAG,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;AACrC,aAAK;AACL,YACI,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;AAClC,SAAG;AAEH,QAAE,6BAAS,GAAT,UACE,KAAkB,EAClB,UAAgB,EAChB,OAAiB,EACjB,iBAAkC,EAClC,UAAqB;AACtB,YAFC,kCAAA,EAAA,yBAAkC;AACpC,YAEE,IAAI,CAAC,KAAK,EAAE;AAChB,gBAAM,OAAO,KAAK,CAAC;AACnB,aAAK;AACL,YACI,IAAI,KAAK,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE;AACnC,gBAAM,OAAO,IAAI,CAAC,wBAAwB,CAClC,KAAK,EACL,UAAU,EACV,OAAO,EACP,iBAAiB,EACjB,UAAU,CACX,CAAC;AACR,aAAK;AACL,YACI,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;AAC9B,gBAAM,OAAO,IAAI,CAAC,SAAS,CACnB,KAAK,CAAC,KAAK,EAAE,EACb,UAAU,EACV,OAAO,EACP,iBAAiB,EACjB,UAAU,CACX,CAAC;AACR,aAAK;AACL,YACI,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;AACnC,gBAAM,OAAO,IAAI,CAAC,eAAe,CACzB,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,KAAK,CAAC,EACxB,UAAU,EACV,OAAO,EACP,iBAAiB,EACjB,UAAU,CACX,CAAC;AACR,aAAK;AACL,YACI,OAAO,KAAK,CAAC;AACjB,SAAG;AAEH;AACM;AAEC;AACP;AACC;AACS;AACJ;AACa;AAEC;AAEX;AAAY,QAFX,6BAAS,GAAT,UACN,KAAY,EACZ,UAAgB,EAChB,OAAiB,EACjB,iBAA2B,EAC3B,UAAqB;AACtB,YACC,IAAM,UAAU,GAAG,UAAU,IAAI,UAAU,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC;AACpE,YACI,IAAI,UAAU,EAAE;AACpB,gBAAM,UAAU,GAAG,SAAS,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;AACzD,aAAK;AACL,YACI,IAAI,SAAmB,CAAC;AAC5B,YACI,IAAI,UAAU,IAAI,OAAO,UAAU,KAAK,UAAU,EAAE;AACxD,gBAAM,SAAS,GAAG,UAAU,CAAC;AAC7B,aAAK;AAAC,iBAAK;AACX,gBAAM,SAAS,GAAG,iBAAiB;AACnC,sBAAU,SAAS,CAAC,mBAAmB;AACvC,sBAAU,SAAS,CAAC,cAAc,CAAC;AACnC,aAAK;AACL,YACI,IAAM,KAAK,GAAU,KAAK,CAAC,IAAI,CAAC,UAAC,CAAM,EAAE,CAAM;AAAI,gBACjD,IAAI,CAAC,UAAU,EAAE;AACvB,oBAAQ,OAAO,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAC/B,iBAAO;AACP,gBACM,IAAI,CAAC,UAAU,EAAE;AACvB,oBAAQ,IAAI,CAAC,IAAI,CAAC,EAAE;AACpB,wBAAU,OAAO,SAAS,CAAC,CAAC,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;AACzD,qBAAS;AACT,oBAAQ,OAAO,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAC/B,iBAAO;AACP,gBACM,OAAO,SAAS,CACd,SAAS,CAAC,QAAQ,CAAC,CAAC,EAAE,UAAU,CAAC,EACjC,SAAS,CAAC,QAAQ,CAAC,CAAC,EAAE,UAAU,CAAC,CAClC,CAAC;AACR,aAAK,CAAC,CAAC;AACP,YACI,IAAI,OAAO,EAAE;AACjB,gBAAM,OAAO,KAAK,CAAC,OAAO,EAAE,CAAC;AAC7B,aAAK;AACL,YACI,OAAO,KAAK,CAAC;AACjB,SAAG;AAEH;AACM;AAEC;AACP;AACC;AACS;AACJ;AACa;AAEC;AACC;AACZ,QAFC,mCAAe,GAAf,UACN,KAAkB,EAClB,UAAgB,EAChB,OAAiB,EACjB,iBAA2B,EAC3B,UAAqB;AACtB,YACC,IAAM,gBAAgB,GAAG,SAAS,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;AACnE,YAAI,IAAI,aAAa,GAAG,gBAAgB,CAAC,GAAG,EAAE,CAAC;AAC/C,YAAI,IAAI,QAAQ,GAAG,SAAS,CAAC,QAAQ,CAAC,KAAK,EAAE,gBAAgB,CAAC,CAAC;AAC/D,YACI,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE;AAClC,gBAAM,gBAAgB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;AAC3C,gBAAM,aAAa,GAAG,IAAI,CAAC;AAC3B,gBAAM,QAAQ,GAAG,SAAS,CAAC,QAAQ,CAAC,KAAK,EAAE,gBAAgB,CAAC,CAAC;AAC7D,aAAK;AACL,YACI,IAAI,CAAC,QAAQ,EAAE;AACnB,gBAAM,OAAO,KAAK,CAAC;AACnB,aAAK;AACL,YACI,SAAS,CAAC,QAAQ,CAChB,KAAK,EACL,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE,aAAa,EAAE,OAAO,EAAE,iBAAiB,CAAC,EACnE,gBAAgB,CACjB,CAAC;AACN,YAAI,OAAO,KAAK,CAAC;AACjB,SAAG;AAEH;AACM;AAEC;AACP;AAAwB;AAExB;AAAoC;AAE5B;AAEc;AACV;AACJ,QAFE,4CAAwB,GAAxB,UACN,KAAU,EACV,WAAkB,EAClB,OAAgB,EAChB,iBAAkC,EAClC,UAAqB;AACtB,YANO,iBAgBP;AACH,YAbI,kCAAA,EAAA,yBAAkC;AACpC,YAEE,OAAO,WAAW,CAAC,OAAO,EAAE,CAAC,MAAM,CAAC,UAAC,MAAW,EAAE,UAAe;AAAI,gBACnE,OAAO,KAAI,CAAC,SAAS,CACnB,MAAM,EACN,UAAU,EACV,OAAO,EACP,iBAAiB,EACjB,UAAU,CACX,CAAC;AACR,aAAK,EAAE,KAAK,CAAC,CAAC;AACd,SAAG;;;;;;;;;gDACH;AAAC;AACwB,SA/QhB;AAAC;AAAC,ICNX;oCDECA,pCCDD;GDCK,HCCL;IDDM,sBACJ,IAAI,EAAE,SAAS,zCCAT;YDCN,IAAI,EAAE,KAAK,vBCAI,QAOjB;SDNC,TCMwB;;;;;;;;;;;gDACnB;AAAC;AAA4B,SAD1B;AAAC;AAAC,ICXX;sCDMCC,tCCLD;ODKS,PCHT;AACO;ODEG,sBACR,7BCHM;EDGM,EAAE,CAAC,SAAS,CAAC,fCFV;AAAmC;CDGlD,OAAO,EAAE,CAAC,SAAS,CAAC,sBACpB,SAAS,EAAE,CAAC,SAAS,CAAC,jECJ6B;AAAmE;AAAC;SDKxH,TCL8H","sourcesContent":["import { Pipe, PipeTransform } from \"@angular/core\";\n\n@Pipe({\n  name: \"orderBy\",\n  pure: false,\n})\nexport class OrderPipe implements PipeTransform {\n  /**\n   * Check if a value is a string\n   *\n   * @param value\n   */\n  static isString(value: any) {\n    return typeof value === \"string\" || value instanceof String;\n  }\n\n  /**\n   * Sorts values ignoring the case\n   *\n   * @param a\n   * @param b\n   */\n  static caseInsensitiveSort(a: any, b: any) {\n    if (OrderPipe.isString(a) && OrderPipe.isString(b)) {\n      return a.localeCompare(b);\n    }\n    return OrderPipe.defaultCompare(a, b);\n  }\n\n  /**\n   * Default compare method\n   *\n   * @param a\n   * @param b\n   */\n  static defaultCompare(a: any, b: any) {\n    if (a && a instanceof Date) {\n      a = a.getTime();\n    }\n    if (b && b instanceof Date) {\n      b = b.getTime();\n    }\n\n    if (a === b) {\n      return 0;\n    }\n    if (a == null) {\n      return 1;\n    }\n    if (b == null) {\n      return -1;\n    }\n    return a > b ? 1 : -1;\n  }\n\n  /**\n   * Parse expression, split into items\n   * @param expression\n   * @returns {string[]}\n   */\n  static parseExpression(expression: string): string[] {\n    expression = expression.replace(/\\[(\\w+)\\]/g, \".$1\");\n    expression = expression.replace(/^\\./, \"\");\n    return expression.split(\".\");\n  }\n\n  /**\n   * Get value by expression\n   *\n   * @param object\n   * @param expression\n   * @returns {any}\n   */\n  static getValue(object: any, expression: string[]) {\n    for (let i = 0, n = expression.length; i < n; ++i) {\n      if (!object) {\n        return;\n      }\n      const k = expression[i];\n      if (!(k in object)) {\n        return;\n      }\n      if (typeof object[k] === \"function\") {\n        object = object[k]();\n      } else {\n        object = object[k];\n      }\n    }\n\n    return object;\n  }\n\n  /**\n   * Set value by expression\n   *\n   * @param object\n   * @param value\n   * @param expression\n   */\n  static setValue(object: any, value: any, expression: string[]) {\n    let i;\n    for (i = 0; i < expression.length - 1; i++) {\n      object = object[expression[i]];\n    }\n\n    object[expression[i]] = value;\n  }\n\n  transform(\n    value: any | any[],\n    expression?: any,\n    reverse?: boolean,\n    isCaseInsensitive: boolean = false,\n    comparator?: Function\n  ): any {\n    if (!value) {\n      return value;\n    }\n\n    if (Array.isArray(expression)) {\n      return this.multiExpressionTransform(\n        value,\n        expression,\n        reverse,\n        isCaseInsensitive,\n        comparator\n      );\n    }\n\n    if (Array.isArray(value)) {\n      return this.sortArray(\n        value.slice(),\n        expression,\n        reverse,\n        isCaseInsensitive,\n        comparator\n      );\n    }\n\n    if (typeof value === \"object\") {\n      return this.transformObject(\n        Object.assign({}, value),\n        expression,\n        reverse,\n        isCaseInsensitive,\n        comparator\n      );\n    }\n\n    return value;\n  }\n\n  /**\n   * Sort array\n   *\n   * @param value\n   * @param expression\n   * @param reverse\n   * @param isCaseInsensitive\n   * @param comparator\n   * @returns {any[]}\n   */\n  private sortArray(\n    value: any[],\n    expression?: any,\n    reverse?: boolean,\n    isCaseInsensitive?: boolean,\n    comparator?: Function\n  ): any[] {\n    const isDeepLink = expression && expression.indexOf(\".\") !== -1;\n\n    if (isDeepLink) {\n      expression = OrderPipe.parseExpression(expression);\n    }\n\n    let compareFn: Function;\n\n    if (comparator && typeof comparator === \"function\") {\n      compareFn = comparator;\n    } else {\n      compareFn = isCaseInsensitive\n        ? OrderPipe.caseInsensitiveSort\n        : OrderPipe.defaultCompare;\n    }\n\n    const array: any[] = value.sort((a: any, b: any): number => {\n      if (!expression) {\n        return compareFn(a, b);\n      }\n\n      if (!isDeepLink) {\n        if (a && b) {\n          return compareFn(a[expression], b[expression]);\n        }\n        return compareFn(a, b);\n      }\n\n      return compareFn(\n        OrderPipe.getValue(a, expression),\n        OrderPipe.getValue(b, expression)\n      );\n    });\n\n    if (reverse) {\n      return array.reverse();\n    }\n\n    return array;\n  }\n\n  /**\n   * Transform Object\n   *\n   * @param value\n   * @param expression\n   * @param reverse\n   * @param isCaseInsensitive\n   * @param comparator\n   * @returns {any[]}\n   */\n  private transformObject(\n    value: any | any[],\n    expression?: any,\n    reverse?: boolean,\n    isCaseInsensitive?: boolean,\n    comparator?: Function\n  ): any {\n    const parsedExpression = OrderPipe.parseExpression(expression);\n    let lastPredicate = parsedExpression.pop();\n    let oldValue = OrderPipe.getValue(value, parsedExpression);\n\n    if (!Array.isArray(oldValue)) {\n      parsedExpression.push(lastPredicate);\n      lastPredicate = null;\n      oldValue = OrderPipe.getValue(value, parsedExpression);\n    }\n\n    if (!oldValue) {\n      return value;\n    }\n\n    OrderPipe.setValue(\n      value,\n      this.transform(oldValue, lastPredicate, reverse, isCaseInsensitive),\n      parsedExpression\n    );\n    return value;\n  }\n\n  /**\n   * Apply multiple expressions\n   *\n   * @param value\n   * @param {any[]} expressions\n   * @param {boolean} reverse\n   * @param {boolean} isCaseInsensitive\n   * @param {Function} comparator\n   * @returns {any}\n   */\n  private multiExpressionTransform(\n    value: any,\n    expressions: any[],\n    reverse: boolean,\n    isCaseInsensitive: boolean = false,\n    comparator?: Function\n  ): any {\n    return expressions.reverse().reduce((result: any, expression: any) => {\n      return this.transform(\n        result,\n        expression,\n        reverse,\n        isCaseInsensitive,\n        comparator\n      );\n    }, value);\n  }\n}\n","/**\n * Created by vadimdez on 20/01/2017.\n */\nimport { NgModule } from '@angular/core';\nimport { OrderPipe } from './ngx-order.pipe';\n\n@NgModule({\n  declarations: [OrderPipe],\n  exports: [OrderPipe],\n  providers: [OrderPipe]\n})\nexport class OrderModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"]}